<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>CodeForces gym 102059 简要题解 | 自由を渇望する</title><meta name="description" content="CodeForces gym 102059 简要题解"><meta name="keywords" content="比赛题解"><meta name="author" content="ldxcaicai"><meta name="copyright" content="ldxcaicai"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/images/8.jpg"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="prev" title="杂题乱做 Round1" href="http://xdl030112.github.io/sol1/"><link rel="next" title="2019.10.15 模拟测试题解" href="http://xdl030112.github.io/191015test/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: true,
  copyright: undefined,
  ClickShowText: {"text":"zxyoi!,backseat_stargazer!,romiqi!,ldxcaicai==,jerome_wei!,dream_maker!,sjkmost!,buzhibujue!,hjk1030!,spacevortex!,jmr!,abuoluo2003!","fontSize":"15px"},
  medium_zoom: false,
  fancybox: false,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">自由を渇望する</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/ldxpig.jpg" onerror="onerror=null;src='/img/cover.png'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">36</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">3</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">2</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">Catalog</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#coloring-roads"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text"> Coloring Roads</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#dev-please-add-this"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text"> Dev, Please Add This!</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#dstorv"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text"> Dstorv</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#dumae"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text"> Dumae</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#electronic-circuit"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text"> Electronic Circuit</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#fake-plastic-trees"><span class="toc_mobile_items-number">6.</span> <span class="toc_mobile_items-text"> Fake Plastic Trees</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#fascination-street"><span class="toc_mobile_items-number">7.</span> <span class="toc_mobile_items-text"> Fascination Street</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#fractions"><span class="toc_mobile_items-number">8.</span> <span class="toc_mobile_items-text"> Fractions</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#game-on-plane"><span class="toc_mobile_items-number">9.</span> <span class="toc_mobile_items-text"> Game on Plane</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#histogram-sequence"><span class="toc_mobile_items-number">10.</span> <span class="toc_mobile_items-text"> Histogram Sequence</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#interesting-drug"><span class="toc_mobile_items-number">11.</span> <span class="toc_mobile_items-text"> Interesting Drug</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#timsort"><span class="toc_mobile_items-number">12.</span> <span class="toc_mobile_items-text"> Timsort</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#utilitarianism"><span class="toc_mobile_items-number">13.</span> <span class="toc_mobile_items-text"> Utilitarianism</span></a></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#coloring-roads"><span class="toc-number">1.</span> <span class="toc-text"> Coloring Roads</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dev-please-add-this"><span class="toc-number">2.</span> <span class="toc-text"> Dev, Please Add This!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dstorv"><span class="toc-number">3.</span> <span class="toc-text"> Dstorv</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dumae"><span class="toc-number">4.</span> <span class="toc-text"> Dumae</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#electronic-circuit"><span class="toc-number">5.</span> <span class="toc-text"> Electronic Circuit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fake-plastic-trees"><span class="toc-number">6.</span> <span class="toc-text"> Fake Plastic Trees</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fascination-street"><span class="toc-number">7.</span> <span class="toc-text"> Fascination Street</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fractions"><span class="toc-number">8.</span> <span class="toc-text"> Fractions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#game-on-plane"><span class="toc-number">9.</span> <span class="toc-text"> Game on Plane</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#histogram-sequence"><span class="toc-number">10.</span> <span class="toc-text"> Histogram Sequence</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#interesting-drug"><span class="toc-number">11.</span> <span class="toc-text"> Interesting Drug</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#timsort"><span class="toc-number">12.</span> <span class="toc-text"> Timsort</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#utilitarianism"><span class="toc-number">13.</span> <span class="toc-text"> Utilitarianism</span></a></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(/img/cover.png)"><div id="post-info"><div id="post-title"><div class="posttitle">CodeForces gym 102059 简要题解</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> Created 2019-10-17<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> Updated 2019-12-27</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/public/">public</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h2 id="coloring-roads"><a class="markdownIt-Anchor" href="#coloring-roads"></a> <a href="https://codeforces.com/gym/102059/problem/A" target="_blank" rel="noopener">Coloring Roads</a></h2>
<p>&#x9898;&#x610F;&#x7B80;&#x8FF0;&#xFF1A;</p>
<blockquote>
<p>&#x7ED9;&#x4E00;&#x68F5;&#x6811;&#xFF0C;&#x6811;&#x8FB9;&#x4E00;&#x5F00;&#x59CB;&#x90FD;&#x662F;&#x65E0;&#x8272;&#x7684;&#xFF0C;&#x6BCF;&#x6B21;&#x64CD;&#x4F5C;&#x53EF;&#x4EE5;&#x628A;&#x4E00;&#x4E2A;&#x70B9;&#x5230;&#x6839;&#x7684;&#x8DEF;&#x5F84;&#x4E0A;&#x6240;&#x6709;&#x8FB9;&#x67D3;&#x6210;&#x67D0;&#x4E2A;&#x989C;&#x8272;&#xFF0C;&#x6BCF;&#x6B21;&#x8BE2;&#x95EE;&#x5F53;&#x524D;&#x6811;&#x4E0A;&#x51FA;&#x73B0;&#x8FC7;&#x67D0;&#x4E2A;&#x6B21;&#x6570;&#x7684;&#x989C;&#x8272;&#x79CD;&#x6570;</p>
</blockquote>
<p>&#x6570;&#x636E;&#x8303;&#x56F4;&#xFF1A;</p>
<ul>
<li>&#x70B9;&#x6570;&#xFF0C;&#x64CD;&#x4F5C;&#x6570; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#x2264;</mo><mn>2</mn><mo>&#xD7;</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">\le2\times10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">&#x2264;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#xD7;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
<p>&#x89E3;&#x9898;&#x601D;&#x8DEF;&#xFF1A;</p>
<blockquote>
<p>&#x8FD9;&#x9898;&#x505A;&#x6CD5;&#x8FD8;&#x86EE;&#x591A;&#x7684;&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x7B80;&#x5355;&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;&#xFF1A;</p>
<ol>
<li>&#x6811;&#x94FE;&#x5256;&#x5206;+&#x5355;&#x8C03;&#x6808;&#xFF1A;&#x5BF9;&#x4E8E;&#x6BCF;&#x6761;&#x91CD;&#x94FE;&#x7EF4;&#x62A4;&#x4E00;&#x4E2A;&#x5173;&#x4E8E; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>f</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">dfs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span></span></span></span> &#x5E8F;&#x7684;&#x5355;&#x8C03;&#x9012;&#x51CF;&#x6808;&#x4ECE;&#x800C;&#x7EF4;&#x62A4;&#x7B54;&#x6848;&#xFF0C;&#x6BCF;&#x6B21;&#x66B4;&#x529B;&#x4FEE;&#x6539;&#xFF0C;&#x5747;&#x644A;&#x5206;&#x6790;&#x590D;&#x6742;&#x5EA6;&#x662F;&#x5BF9;&#x7684;</li>
<li>&#x6811;&#x94FE;&#x5256;&#x5206;+ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mi>D</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">ODT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span> &#xFF0C;&#x7531;&#x4E8E;&#x6709;&#x8DEF;&#x5F84;&#x8986;&#x76D6;&#x64CD;&#x4F5C;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x7528; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mi>D</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">ODT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span> &#x7B80;&#x5355;&#x7EF4;&#x62A4;&#x7B54;&#x6848;&#xFF0C;&#x590D;&#x6742;&#x5EA6;&#x5206;&#x6790;&#x8DDF;&#x5E8F;&#x5217;&#x4E0A;&#x662F;&#x5DEE;&#x4E0D;&#x591A;&#x7684;</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mi>C</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">LCT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span> &#xFF0C;&#x8003;&#x8651;&#x5230;&#x8DEF;&#x5F84;&#x8986;&#x76D6;&#x5C31;&#x662F; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mi>C</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">LCT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span> &#x5728; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">access</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span></span></span></span> &#x7684;&#x65F6;&#x5019;&#x987A;&#x5E26;&#x4FEE;&#x6539;&#x4E00;&#x4E0B;&#x4FE1;&#x606F;&#xFF0C;&#x56E0;&#x6B64;&#x6BCF;&#x6B21;&#x6539;&#x7684;&#x65F6;&#x5019; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">access</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span></span></span></span> &#x5373;&#x53EF;</li>
</ol>
</blockquote>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> rlen=<span class="number">1</span>&lt;&lt;<span class="number">18</span>|<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">gc</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">char</span> buf[rlen],*ib,*ob;</span><br><span class="line">	(ib==ob)&amp;&amp;(ob=(ib=buf)+fread(buf,<span class="number">1</span>,rlen,<span class="built_in">stdin</span>));</span><br><span class="line">	<span class="keyword">return</span> ib==ob?<span class="number">-1</span>:*ib++;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">4e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt;S[N];</span><br><span class="line"><span class="keyword">int</span> cnt[N];</span><br><span class="line"><span class="keyword">namespace</span> lct{</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> lc (son[p][0])</span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> rc (son[p][1])</span></span><br><span class="line">	<span class="keyword">int</span> siz[N],fa[N],son[N][<span class="number">2</span>],vl[N],col[N];</span><br><span class="line">	<span class="keyword">bool</span> rev[N];</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">which</span><span class="params">(<span class="keyword">int</span> x)</span></span>{<span class="keyword">return</span> x==son[fa[x]][<span class="number">1</span>];}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">isroot</span><span class="params">(<span class="keyword">int</span> x)</span></span>{<span class="keyword">return</span> !fa[x]||(son[fa[x]][<span class="number">0</span>]!=x&amp;&amp;son[fa[x]][<span class="number">1</span>]!=x);}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> p)</span></span>{siz[p]=siz[lc]+siz[rc]+vl[p];}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushnow</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> c)</span></span>{col[p]=c;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> p)</span></span>{(lc&amp;&amp;(col[lc]=col[p])),(rc&amp;&amp;(col[rc]=col[p]));}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span>{</span><br><span class="line">		<span class="keyword">int</span> y=fa[x],z=fa[y],t=which(x);</span><br><span class="line">		<span class="keyword">if</span>(!isroot(y))son[z][which(y)]=x;</span><br><span class="line">		fa[x]=z,fa[y]=x,son[y][t]=son[x][t^<span class="number">1</span>],son[x][t^<span class="number">1</span>]=y;</span><br><span class="line">		<span class="keyword">if</span>(son[y][t])fa[son[y][t]]=y;</span><br><span class="line">		pushup(y),pushup(x);</span><br><span class="line">	}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span></span>{</span><br><span class="line">		<span class="keyword">static</span> <span class="keyword">int</span> stk[N],top;</span><br><span class="line">		stk[top=<span class="number">1</span>]=x;</span><br><span class="line">		<span class="keyword">for</span>(ri i=x;!isroot(i);i=fa[i])stk[++top]=fa[i];</span><br><span class="line">		<span class="keyword">while</span>(top)pushdown(stk[top--]);</span><br><span class="line">		<span class="keyword">while</span>(!isroot(x)){</span><br><span class="line">			<span class="keyword">if</span>(!isroot(fa[x]))rotate(which(x)^which(fa[x])?x:fa[x]);</span><br><span class="line">			rotate(x);</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">access</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> c)</span></span>{</span><br><span class="line">		<span class="keyword">int</span> p=x;</span><br><span class="line">		<span class="keyword">for</span>(ri y=<span class="number">0</span>;x;x=fa[y=x]){</span><br><span class="line">			splay(x);</span><br><span class="line">			son[x][<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">			pushup(x); </span><br><span class="line">			S[cnt[col[x]]].erase(col[x]);</span><br><span class="line">			cnt[col[x]]-=siz[x];</span><br><span class="line">			S[cnt[col[x]]].insert(col[x]);</span><br><span class="line">			son[x][<span class="number">1</span>]=y;</span><br><span class="line">			pushup(x);</span><br><span class="line">			p=x;</span><br><span class="line">		}</span><br><span class="line">		pushnow(p,c);</span><br><span class="line">		S[cnt[col[p]]].erase(col[p]);</span><br><span class="line">		cnt[col[p]]+=siz[p];</span><br><span class="line">		S[cnt[col[p]]].insert(col[p]);</span><br><span class="line">	}</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">undef</span> lc</span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">undef</span> rc</span></span><br><span class="line">}</span><br><span class="line"><span class="keyword">int</span> n,C,m;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;e[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> fa)</span></span>{</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>,v;i&lt;e[p].size();++i){</span><br><span class="line">		<span class="keyword">if</span>((v=e[p][i])==fa)<span class="keyword">continue</span>;</span><br><span class="line">		dfs(v,p);</span><br><span class="line">		lct::fa[lct::fa[v]=v+n]=p;</span><br><span class="line">		lct::siz[v+n]=lct::vl[v+n]=<span class="number">1</span>;</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read(),C=read(),m=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=C;++i)S[<span class="number">0</span>].insert(i);</span><br><span class="line">	S[n<span class="number">-1</span>].insert(<span class="number">0</span>);</span><br><span class="line">	cnt[<span class="number">0</span>]=n<span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>,u,v;i&lt;n;++i){</span><br><span class="line">		u=read(),v=read();</span><br><span class="line">		e[u].pb(v),e[v].pb(u);</span><br><span class="line">	}</span><br><span class="line">	dfs(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span>(ri x,c,k;m;--m){</span><br><span class="line">		x=read(),c=read(),k=read();</span><br><span class="line">		lct::access(x,c);</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;S[k].size()-(S[k].count(<span class="number">0</span>)?<span class="number">1</span>:<span class="number">0</span>)&lt;&lt;<span class="string">&apos;\n&apos;</span>;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="dev-please-add-this"><a class="markdownIt-Anchor" href="#dev-please-add-this"></a> <a href="https://codeforces.com/gym/102059/problem/B" target="_blank" rel="noopener">Dev, Please Add This!</a></h2>
<p>&#x9898;&#x610F;&#x7B80;&#x8FF0;&#xFF1A;</p>
<blockquote>
<p>&#x7ED9;&#x4E00;&#x4E2A; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>&#x2217;</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n*m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> &#x7684;&#x7F51;&#x683C;&#x56FE;&#xFF0C;&#x4E00;&#x4E2A;&#x683C;&#x5B50;&#x662F;&#x7A7A;&#x5730;&#x6216;&#x5899;&#xFF0C;&#x7A7A;&#x5730;&#x4E0A;&#x53EF;&#x80FD;&#x6709;&#x9053;&#x5177;&#x3002;&#x4F60;&#x4ECE;&#x4E00;&#x4E2A;&#x4F4D;&#x7F6E;&#x51FA;&#x53D1;&#xFF0C;&#x9009;&#x4E00;&#x4E2A;&#x65B9;&#x5411;&#x7136;&#x540E;&#x4E00;&#x76F4;&#x6309;&#x90A3;&#x4E2A;&#x65B9;&#x5411;&#x8D70;&#x76F4;&#x5230;&#x78B0;&#x5230;&#x5899;&#x6216;&#x8FB9;&#x754C;&#x3002;&#x6CBF;&#x9014;&#x7684;&#x6240;&#x6709;&#x9053;&#x5177;&#x90FD;&#x4F1A;&#x88AB;&#x6536;&#x96C6;&#xFF0C;&#x95EE;&#x80FD;&#x5426;&#x6536;&#x96C6;&#x6240;&#x6709;&#x9053;&#x5177;&#x3002;</p>
</blockquote>
<p>&#x6570;&#x636E;&#x8303;&#x56F4;&#xFF1A;</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo>&#x2264;</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">n,m\le50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304100000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2264;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">0</span></span></span></span></li>
</ul>
<p>&#x89E3;&#x9898;&#x601D;&#x8DEF;&#xFF1A;</p>
<blockquote>
<p>&#x6839;&#x636E;&#x9898;&#x610F;&#xFF0C;&#x6BCF;&#x884C;&#x6BCF;&#x5217;&#x90FD;&#x88AB;&#x8FB9;&#x754C;&#x548C;&#x5899;&#x5206;&#x6210;&#x4E86;&#x5F88;&#x591A;&#x5C0F;&#x6BB5;&#xFF0C;&#x6211;&#x4EEC;&#x628A;&#x8FD9;&#x4E9B;&#x6BB5;&#x8FDB;&#x884C;&#x6807;&#x53F7;&#xFF0C;&#x90A3;&#x4E48;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x9053;&#x5177;&#xFF0C;&#x5B83;&#x88AB;&#x6536;&#x96C6;&#x5F53;&#x4E14;&#x4EC5;&#x5F53;&#x5B83;&#x6240;&#x5728;&#x7684;&#x884C;&#x5217;&#x5206;&#x91CF;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x88AB;&#x9009;&#xFF0C;&#x4E8E;&#x662F;&#x60F3;&#x5230;&#x7528; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mo>&#x2212;</mo><mi>s</mi><mi>a</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">2-sat</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span></span></span></span> &#x6765;&#x8FDB;&#x884C;&#x8FD9;&#x7C7B;&#x9650;&#x5236;&#xFF0C;&#x7136;&#x540E;&#x8003;&#x8651;&#x5269;&#x4E0B;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x82E5;&#x4ECE;&#x8D77;&#x70B9;&#x51FA;&#x53D1;&#x4E0D;&#x80FD;&#x5230;&#x8FBE;&#x67D0;&#x4E2A;&#x5206;&#x91CF;&#xFF0C;&#x90A3;&#x4E48;&#x6700;&#x540E;&#x5B83;&#x5FC5;&#x987B;&#x4E3A; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mi>a</mi><mi>l</mi><mi>s</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">false</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span></span></span></span> &#xFF0C;&#x5982;&#x679C;&#x4E24;&#x4E2A;&#x5206;&#x91CF;&#x6CA1;&#x6709;&#x4E00;&#x4E2A;&#x80FD;&#x5230;&#x8FBE;&#x53E6;&#x4E00;&#x4E2A;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4E0D;&#x80FD;&#x540C;&#x65F6;&#x4E3A; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">true</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span></span></span></span> &#xFF0C;&#x5EFA;&#x5B8C;&#x56FE;&#x4E4B;&#x540E;&#x7528; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mo>&#x2212;</mo><mi>s</mi><mi>a</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">2-sat</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span></span></span></span> &#x8DD1;&#x5373;&#x53EF;</p>
<p>&#x5408;&#x6CD5;&#x6027;&#x8BC1;&#x660E;&#xFF1A;&#x8003;&#x8651;&#x5C06;&#x5EFA;&#x51FA;&#x6765;&#x7684;&#x56FE;&#x7F29;&#x70B9;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53D8;&#x6210;&#x4E86;&#x4E00;&#x5F20;&#x6709;&#x5411;&#x5B8C;&#x5168;&#x56FE;&#xFF0C;&#x4ECE;&#x4E00;&#x4E2A;&#x5165;&#x5EA6;&#x4E3A; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> &#x7684;&#x70B9;&#x51FA;&#x53D1;&#x627E;&#x54C8;&#x5BC6;&#x987F;&#x56DE;&#x8DEF;&#xFF0C;&#x8FD9;&#x4E2A;&#x4E00;&#x5B9A;&#x80FD;&#x6784;&#x9020;&#x51FA;&#x4E00;&#x7EC4;&#x89E3;</p>
</blockquote>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> rlen=<span class="number">1</span>&lt;&lt;<span class="number">18</span>|<span class="number">1</span>;</span><br><span class="line"><span class="keyword">char</span> buf[rlen],*ib=buf,*ob=buf;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc() (((ib==ob)&amp;&amp;(ob=(ib=buf)+fread(buf,1,rlen,stdin)),ib==ob)?-1:*ib++)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,ll&gt; pll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,<span class="keyword">int</span>&gt; pli;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> uii;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> Ull;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; poly;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">readl</span><span class="params">()</span></span>{</span><br><span class="line">	ll ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Read</span><span class="params">(<span class="keyword">char</span>*s)</span></span>{</span><br><span class="line">	<span class="keyword">int</span> top=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(ch!=<span class="string">&apos;O&apos;</span>&amp;&amp;ch!=<span class="string">&apos;#&apos;</span>&amp;&amp;ch!=<span class="string">&apos;.&apos;</span>&amp;&amp;ch!=<span class="string">&apos;*&apos;</span>)ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(ch==<span class="string">&apos;O&apos;</span>||ch==<span class="string">&apos;#&apos;</span>||ch==<span class="string">&apos;.&apos;</span>||ch==<span class="string">&apos;*&apos;</span>)s[++top]=ch,ch=gc();</span><br><span class="line">	<span class="keyword">return</span> top;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">namespace</span> modular{</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">998244353</span>,inv2=<span class="number">499122177</span>;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> a+b&lt;mod?a+b:a+b-mod;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> a-b&lt;<span class="number">0</span>?a-b+mod:a-b;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (ll)a*b%mod;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=add(a,b);}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=dec(a,b);}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=(ll)a*b%mod;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>{<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))(p&amp;<span class="number">1</span>)&amp;&amp;(Mul(ret,a),<span class="number">1</span>);<span class="keyword">return</span> ret;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> a)</span></span>{<span class="keyword">return</span> ksm(a,mod<span class="number">-2</span>);}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">fix</span><span class="params">(<span class="keyword">int</span>&amp;a)</span></span>{a=(a%mod+mod)%mod;}</span><br><span class="line">}</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> modular;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmax</span><span class="params">(T&amp;a,T b)</span></span>{a&lt;b?a=b:<span class="number">0</span>;}</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmin</span><span class="params">(T&amp;a,T b)</span></span>{a&gt;b?a=b:<span class="number">0</span>;}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">55</span>,M=N*N*<span class="number">4</span>;</span><br><span class="line"><span class="keyword">char</span> s[N][N];</span><br><span class="line"><span class="keyword">int</span> n,m,sig=<span class="number">0</span>,col[M],stk[M],top=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> vs[M];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;e[M];</span><br><span class="line"><span class="keyword">int</span> tot=<span class="number">0</span>,low[M],dfn[M];</span><br><span class="line"><span class="keyword">bool</span> trans[M][M];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> p)</span></span>{</span><br><span class="line">	dfn[p]=low[p]=++tot;</span><br><span class="line">	stk[++top]=p;</span><br><span class="line">	vs[p]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>,v;i&lt;e[p].size();++i){</span><br><span class="line">		<span class="keyword">if</span>(dfn[v=e[p][i]]){</span><br><span class="line">			<span class="keyword">if</span>(vs[v])low[p]=min(low[p],low[v]);</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		}</span><br><span class="line">		dfs(v),low[p]=min(low[p],low[v]);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">if</span>(low[p]==dfn[p]){</span><br><span class="line">		++sig;</span><br><span class="line">		<span class="keyword">while</span>(<span class="number">1</span>){</span><br><span class="line">			<span class="keyword">int</span> x=stk[top--];</span><br><span class="line">			vs[x]=<span class="number">0</span>;</span><br><span class="line">			col[x]=sig;</span><br><span class="line">			<span class="keyword">if</span>(x==p)<span class="keyword">break</span>;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"><span class="keyword">int</span> idx1[N][N],idx2[N][N],cnt=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">gettrans</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> rt)</span></span>{</span><br><span class="line">	trans[rt][p]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;e[p].size();++i)</span><br><span class="line">	<span class="keyword">if</span>(!trans[rt][e[p][i]])gettrans(e[p][i],rt);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read(),m=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)Read(s[i]);</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;=n+<span class="number">1</span>;++i)s[i][<span class="number">0</span>]=s[i][m+<span class="number">1</span>]=<span class="string">&apos;#&apos;</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;=m+<span class="number">1</span>;++i)s[<span class="number">0</span>][i]=s[n+<span class="number">1</span>][i]=<span class="string">&apos;#&apos;</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)<span class="keyword">for</span>(ri j=<span class="number">1</span>;j&lt;=m;++j){</span><br><span class="line">		<span class="keyword">if</span>(s[i][j<span class="number">-1</span>]==<span class="string">&apos;#&apos;</span>&amp;&amp;s[i][j]!=<span class="string">&apos;#&apos;</span>)++cnt;</span><br><span class="line">		idx1[i][j]=cnt;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=m;++i)<span class="keyword">for</span>(ri j=<span class="number">1</span>;j&lt;=n;++j){</span><br><span class="line">		<span class="keyword">if</span>(s[j<span class="number">-1</span>][i]==<span class="string">&apos;#&apos;</span>&amp;&amp;s[j][i]!=<span class="string">&apos;#&apos;</span>)++cnt;</span><br><span class="line">		idx2[j][i]=cnt;</span><br><span class="line">	}</span><br><span class="line">	++cnt;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)<span class="keyword">for</span>(ri j=<span class="number">1</span>;j&lt;=m;++j){</span><br><span class="line">		<span class="keyword">if</span>(s[i][j]==<span class="string">&apos;#&apos;</span>)<span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">if</span>(s[i][j<span class="number">-1</span>]==<span class="string">&apos;#&apos;</span>||s[i][j+<span class="number">1</span>]==<span class="string">&apos;#&apos;</span>)e[idx1[i][j]].pb(idx2[i][j]);</span><br><span class="line">		<span class="keyword">if</span>(s[i<span class="number">-1</span>][j]==<span class="string">&apos;#&apos;</span>||s[i+<span class="number">1</span>][j]==<span class="string">&apos;#&apos;</span>)e[idx2[i][j]].pb(idx1[i][j]);</span><br><span class="line">		<span class="keyword">if</span>(s[i][j]==<span class="string">&apos;O&apos;</span>)e[cnt].pb(idx1[i][j]),e[cnt].pb(idx2[i][j]);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=cnt;++i)gettrans(i,i);</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=cnt;++i)e[i].clear();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)<span class="keyword">for</span>(ri j=<span class="number">1</span>;j&lt;=m;++j)<span class="keyword">if</span>(s[i][j]==<span class="string">&apos;*&apos;</span>){</span><br><span class="line">		e[idx1[i][j]].pb(idx2[i][j]+cnt);</span><br><span class="line">		e[idx2[i][j]].pb(idx1[i][j]+cnt);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;cnt;++i)<span class="keyword">if</span>(!trans[cnt][i])e[i+cnt].pb(i);</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;cnt;++i)<span class="keyword">for</span>(ri j=i+<span class="number">1</span>;j&lt;cnt;++j)<span class="keyword">if</span>(!trans[i][j]&amp;&amp;!trans[j][i]){</span><br><span class="line">		e[i+cnt].pb(j);</span><br><span class="line">		e[j+cnt].pb(i);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;cnt*<span class="number">2</span>;++i)<span class="keyword">if</span>(!dfn[i])dfs(i);</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;cnt;++i)<span class="keyword">if</span>(col[i]==col[i+cnt]){</span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	}</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="dstorv"><a class="markdownIt-Anchor" href="#dstorv"></a> <a href="https://codeforces.com/gym/102059/problem/C" target="_blank" rel="noopener">Dstorv</a></h2>
<p>&#x9898;&#x610F;&#x7B80;&#x8FF0;&#xFF1A;</p>
<blockquote>
<p>&#x6570;&#x8F74;&#x4E0A;&#x6392;&#x5217;&#x7740; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> &#x4E2A;&#x5DE6;/&#x53F3;&#x7BAD;&#x5934;&#xFF0C;&#x6BCF;&#x4E2A;&#x7BAD;&#x5934;&#x90FD;&#x4F1A;&#x4EE5;&#x76F8;&#x540C;&#x901F;&#x5EA6;&#x671D;&#x7740;&#x5404;&#x81EA;&#x65B9;&#x5411;&#x79FB;&#x52A8;&#x3002;&#x5F53;&#x4E00;&#x4E2A;&#x5DE6;&#x7BAD;&#x5934;&#x548C;&#x4E00;&#x4E2A;&#x53F3;&#x7BAD;&#x5934;&#x76F8;&#x9047;&#x65F6;&#x6709;&#x6982;&#x7387; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> &#x4F7F;&#x5F97;&#x5176;&#x4E2D;&#x5DE6;&#x7BAD;&#x5934;&#x6D88;&#x5931;&#xFF0C; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>&#x2212;</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">1-p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> &#x6982;&#x7387;&#x4F7F;&#x53F3;&#x7BAD;&#x5934;&#x6D88;&#x5931;&#xFF0C;&#x95EE;&#x6700;&#x540E;&#x5269;&#x4E0B; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span> &#x4E2A;&#x53F3;&#x7BAD;&#x5934;&#x548C; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span> &#x4E2A;&#x5DE6;&#x7BAD;&#x5934;&#x7684;&#x6982;&#x7387;&#x3002;</p>
</blockquote>
<p>&#x6570;&#x636E;&#x8303;&#x56F4;&#xFF1A;</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>&#x2264;</mo><mn>5000</mn></mrow><annotation encoding="application/x-tex">n\le5000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2264;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span></li>
</ul>
<p>&#x89E3;&#x9898;&#x601D;&#x8DEF;&#xFF1A;</p>
<blockquote>
<p>&#x5BF9;&#x4E8E;&#x6BCF;&#x4E00;&#x79CD;&#x5408;&#x6CD5;&#x65B9;&#x6848;&#xFF0C;&#x5BF9;&#x5E94;&#x7740;&#x5728;&#x6700;&#x53F3;&#x7684;&#x5DE6;&#x7BAD;&#x5934;&#x548C;&#x6700;&#x5DE6;&#x7684;&#x53F3;&#x7BAD;&#x5934;&#x4E4B;&#x95F4;&#x5212;&#x4E00;&#x9053;&#x5206;&#x754C;&#x7EBF;&#xFF0C;&#x7136;&#x540E;&#x5206;&#x754C;&#x7EBF;&#x5DE6;&#x4FA7;&#x7684;&#x53F3;&#x7BAD;&#x5934;&#x5168;&#x90E8; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">gg</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span> &#xFF0C;&#x5206;&#x754C;&#x7EBF;&#x53F3;&#x4FA7;&#x7684;&#x5DE6;&#x7BAD;&#x5934;&#x5168;&#x90E8; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">gg</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span> &#xFF0C;&#x8FD9;&#x6837;&#x5982;&#x679C;&#x7EDF;&#x8BA1;&#x51FA;&#x5206;&#x754C;&#x7EBF;&#x5DE6;&#x53F3;&#x90E8;&#x5206;&#x5408;&#x6CD5;&#x7684;&#x6982;&#x7387;&#x5C31;&#x53EF;&#x4EE5;&#x679A;&#x4E3E;&#x5206;&#x754C;&#x7EBF;&#x7EDF;&#x8BA1;&#x7B54;&#x6848;</p>
<p>&#x73B0;&#x5728;&#x8003;&#x8651;&#x5982;&#x4F55;&#x6C42;&#x6982;&#x7387;&#xFF0C;&#x8BBE; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> &#x8868;&#x793A;&#x4ECE;&#x5DE6;&#x5230;&#x53F3;&#x5904;&#x7406;&#x5230;&#x7B2C; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> &#x4E2A;&#x7BAD;&#x5934;&#xFF0C;&#x6700;&#x540E;&#x4F1A;&#x4ECE;&#x53F3;&#x8FB9;&#x6765; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span> &#x4E2A;&#x5DE6;&#x7BAD;&#x5934;&#x8FDB;&#x884C;&#x652F;&#x63F4;&#xFF0C;&#x6700;&#x540E;&#x5269;&#x4E0B; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span> &#x4E2A;&#x5DE6;&#x7BAD;&#x5934;&#x7684;&#x6982;&#x7387;&#xFF0C;&#x7136;&#x540E;&#x8F6C;&#x79FB;&#x5373;&#x53EF;&#xFF0C;&#x53F3;&#x4FA7;&#x7684;&#x8F6C;&#x79FB;&#x540C;&#x7406;</p>
</blockquote>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> rlen=<span class="number">1</span>&lt;&lt;<span class="number">18</span>|<span class="number">1</span>;</span><br><span class="line"><span class="keyword">char</span> buf[rlen],*ib=buf,*ob=buf;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc() (((ib==ob)&amp;&amp;(ob=(ib=buf)+fread(buf,1,rlen,stdin)),ib==ob)?-1:*ib++)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,ll&gt; pll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,<span class="keyword">int</span>&gt; pli;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> uii;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> Ull;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; poly;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">readl</span><span class="params">()</span></span>{</span><br><span class="line">	ll ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Read</span><span class="params">(<span class="keyword">char</span>*s)</span></span>{</span><br><span class="line">	<span class="keyword">int</span> top=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isalpha</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isalpha</span>(ch))s[++top]=ch,ch=gc();</span><br><span class="line">	<span class="keyword">return</span> top;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">namespace</span> modular{</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> a+b&lt;mod?a+b:a+b-mod;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> a-b&lt;<span class="number">0</span>?a-b+mod:a-b;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (ll)a*b%mod;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=add(a,b);}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=dec(a,b);}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=(ll)a*b%mod;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>{<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))(p&amp;<span class="number">1</span>)&amp;&amp;(Mul(ret,a),<span class="number">1</span>);<span class="keyword">return</span> ret;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> a)</span></span>{<span class="keyword">return</span> ksm(a,mod<span class="number">-2</span>);}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">fix</span><span class="params">(<span class="keyword">int</span>&amp;a)</span></span>{a=(a%mod+mod)%mod;}</span><br><span class="line">}</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> modular;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmax</span><span class="params">(T&amp;a,T b)</span></span>{a&lt;b?a=b:<span class="number">0</span>;}</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmin</span><span class="params">(T&amp;a,T b)</span></span>{a&gt;b?a=b:<span class="number">0</span>;}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">5005</span>;</span><br><span class="line"><span class="keyword">int</span> f[N][N],g[N][N],pa,pb,p,n,A,B;</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read(),pa=read(),pb=read();</span><br><span class="line">	Mul(pa,Inv(pa+pb));</span><br><span class="line">	pb=dec(<span class="number">1</span>,pa);</span><br><span class="line">	Read(s);</span><br><span class="line">	A=read(),B=read();</span><br><span class="line">	f[<span class="number">0</span>][B]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i){</span><br><span class="line">		<span class="keyword">if</span>(s[i]==<span class="string">&apos;H&apos;</span>)<span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;n;++j)f[i][j]=f[i<span class="number">-1</span>][j+<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">for</span>(ri j=<span class="number">1</span>;j&lt;=n;++j)f[i][j]=add(mul(f[i][j<span class="number">-1</span>],pb),mul(f[i<span class="number">-1</span>][j],pa));</span><br><span class="line">	}</span><br><span class="line">	g[n+<span class="number">1</span>][A]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=n;i;--i){</span><br><span class="line">		<span class="keyword">if</span>(s[i]==<span class="string">&apos;R&apos;</span>)<span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;n;++j)g[i][j]=g[i+<span class="number">1</span>][j+<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">for</span>(ri j=<span class="number">1</span>;j&lt;=n;++j)g[i][j]=add(mul(g[i][j<span class="number">-1</span>],pa),mul(g[i+<span class="number">1</span>][j],pb));</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;=n;++i)Add(res,mul(f[i][<span class="number">0</span>],g[i+<span class="number">1</span>][<span class="number">0</span>]));</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;res;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="dumae"><a class="markdownIt-Anchor" href="#dumae"></a> <a href="https://codeforces.com/gym/102059/problem/D" target="_blank" rel="noopener">Dumae</a></h2>
<p>&#x5EFA;&#x62D3;&#x6251;&#x56FE;+&#x8D2A;&#x5FC3;&#x5373;&#x53EF;</p>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc getchar</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))f^=ch==<span class="string">&apos;-&apos;</span>,ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> f?ans:-ans;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">readl</span><span class="params">()</span></span>{</span><br><span class="line">	ll ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,ll&gt; pll;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (a+=b)&lt;mod?a:a-mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (a-=b)&lt;<span class="number">0</span>?a+mod:a;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (ll)a*b%mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{(a+=b)&lt;mod?a:(a-=mod);}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{(a-=b)&lt;<span class="number">0</span>?(a+=mod):a;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=(ll)a*b%mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>{<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))<span class="keyword">if</span>(p&amp;<span class="number">1</span>)Mul(ret,a);<span class="keyword">return</span> ret;}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">3e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,L[N],R[N],du[N],q[N],hd,tl,Du[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;e[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;pii&gt;a[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read(),m=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)L[i]=read(),R[i]=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>,u,v;i&lt;=m;++i){</span><br><span class="line">		u=read(),v=read();</span><br><span class="line">		e[u].pb(v),++du[v],++Du[v];</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">int</span> cnt=n;</span><br><span class="line">	hd=<span class="number">1</span>,tl=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)<span class="keyword">if</span>(!du[i])q[++tl]=i;</span><br><span class="line">	<span class="keyword">while</span>(hd&lt;=tl){</span><br><span class="line">		<span class="keyword">int</span> x=q[hd++];</span><br><span class="line">		--cnt;</span><br><span class="line">		<span class="keyword">for</span>(ri i=<span class="number">0</span>,v;i&lt;e[x].size();++i){</span><br><span class="line">			--du[v=e[x][i]];</span><br><span class="line">			<span class="keyword">if</span>(!du[v])q[++tl]=v;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">if</span>(cnt)<span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>),<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri p,i=n;i;--i){</span><br><span class="line">		p=q[i];</span><br><span class="line">		<span class="keyword">for</span>(ri j=<span class="number">0</span>,v;j&lt;e[p].size();++j)R[p]=min(R[p],R[v=e[p][j]]<span class="number">-1</span>);</span><br><span class="line">	}</span><br><span class="line">	<span class="built_in">set</span>&lt;pii&gt;S,qu;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;ans;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)<span class="keyword">if</span>(!Du[i]){</span><br><span class="line">		<span class="keyword">if</span>(L[i]==<span class="number">1</span>)qu.insert(pii(R[i],i));</span><br><span class="line">		<span class="keyword">else</span> S.insert(pii(L[i],i));</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">while</span>(qu.size()){</span><br><span class="line">		<span class="keyword">int</span> x=qu.begin()-&gt;se;</span><br><span class="line">		qu.erase(qu.begin());</span><br><span class="line">		++cnt;</span><br><span class="line">		<span class="keyword">if</span>(R[x]&lt;cnt)<span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>),<span class="number">0</span>;</span><br><span class="line">		ans.pb(x);</span><br><span class="line">		<span class="keyword">while</span>(S.size()&amp;&amp;S.begin()-&gt;fi&lt;=cnt+<span class="number">1</span>)qu.insert(pii(R[S.begin()-&gt;se],S.begin()-&gt;se)),S.erase(S.begin());</span><br><span class="line">		<span class="keyword">for</span>(ri i=<span class="number">0</span>,v;i&lt;e[x].size();++i){</span><br><span class="line">			--Du[v=e[x][i]];</span><br><span class="line">			<span class="keyword">if</span>(!Du[v]){</span><br><span class="line">				<span class="keyword">if</span>(L[v]&lt;=cnt+<span class="number">1</span>)qu.insert(pii(R[v],v));</span><br><span class="line">				<span class="keyword">else</span> S.insert(pii(L[v],v));</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">if</span>(ans.size()!=n)<span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>),<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;ans.size();++i)<span class="built_in">cout</span>&lt;&lt;ans[i]&lt;&lt;<span class="string">&apos;\n&apos;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="electronic-circuit"><a class="markdownIt-Anchor" href="#electronic-circuit"></a> <a href="https://codeforces.com/gym/102059/problem/E" target="_blank" rel="noopener">Electronic Circuit</a></h2>
<p>&#x9006;&#x5411;&#x8003;&#x8651;&#x7136;&#x540E;&#x6309;&#x7167;&#x9898;&#x610F;&#x6A21;&#x62DF;</p>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc getchar</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))f^=ch==<span class="string">&apos;-&apos;</span>,ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> f?ans:-ans;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">readl</span><span class="params">()</span></span>{</span><br><span class="line">	ll ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,ll&gt; pll;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (a+=b)&lt;mod?a:a-mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (a-=b)&lt;<span class="number">0</span>?a+mod:a;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (ll)a*b%mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{(a+=b)&lt;mod?a:(a-=mod);}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{(a-=b)&lt;<span class="number">0</span>?(a+=mod):a;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=(ll)a*b%mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>{<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))<span class="keyword">if</span>(p&amp;<span class="number">1</span>)Mul(ret,a);<span class="keyword">return</span> ret;}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt;e[N];</span><br><span class="line"><span class="keyword">bool</span> ban[N];</span><br><span class="line"><span class="keyword">int</span> n,m,cnt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> p)</span></span>{</span><br><span class="line">	<span class="keyword">if</span>(ban[p])<span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">if</span>(e[p].size()^<span class="number">2</span>)<span class="keyword">return</span>;</span><br><span class="line">	--cnt;</span><br><span class="line">	ban[p]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> pre=*e[p].begin(),suf=*e[p].rbegin();</span><br><span class="line">	e[pre].erase(p);</span><br><span class="line">	e[pre].insert(suf);</span><br><span class="line">	e[suf].erase(p);</span><br><span class="line">	e[suf].insert(pre);</span><br><span class="line">	modify(pre),modify(suf);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read(),m=read();</span><br><span class="line">	cnt=n;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>,u,v;i&lt;=m;++i){</span><br><span class="line">		u=read(),v=read();</span><br><span class="line">		e[u].insert(v);</span><br><span class="line">		e[v].insert(u);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)modify(i);</span><br><span class="line">	<span class="built_in">puts</span>(cnt==<span class="number">2</span>?<span class="string">&quot;Yes&quot;</span>:<span class="string">&quot;No&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="fake-plastic-trees"><a class="markdownIt-Anchor" href="#fake-plastic-trees"></a> <a href="https://codeforces.com/gym/102059/problem/F" target="_blank" rel="noopener">Fake Plastic Trees</a></h2>
<p>&#x6BCF;&#x6B21;&#x5747;&#x5206;&#x53F6;&#x5B50;&#x7ED9;&#x5B50;&#x6811;&#xFF0C;&#x8BB0;&#x5FC6;&#x5316;&#x4E00;&#x4E0B;&#x5C31;&#x884C;&#x4E86;</p>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc getchar</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))f^=ch==<span class="string">&apos;-&apos;</span>,ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> f?ans:-ans;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">readl</span><span class="params">()</span></span>{</span><br><span class="line">	ll ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,ll&gt; pll;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (a+=b)&lt;mod?a:a-mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (a-=b)&lt;<span class="number">0</span>?a+mod:a;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (ll)a*b%mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{(a+=b)&lt;mod?a:(a-=mod);}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{(a-=b)&lt;<span class="number">0</span>?(a+=mod):a;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=(ll)a*b%mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>{<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))<span class="keyword">if</span>(p&amp;<span class="number">1</span>)Mul(ret,a);<span class="keyword">return</span> ret;}</span><br><span class="line"><span class="built_in">vector</span>&lt;ll&gt;vl;</span><br><span class="line"><span class="built_in">map</span>&lt;ll,<span class="keyword">int</span>&gt;idx;</span><br><span class="line"><span class="built_in">map</span>&lt;ll,<span class="keyword">bool</span>&gt;vs;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(ll x)</span></span>{</span><br><span class="line">	<span class="keyword">if</span>(vs[x])<span class="keyword">return</span>;</span><br><span class="line">	vs[x]=<span class="number">1</span>;</span><br><span class="line">	vl.pb(x);</span><br><span class="line">	<span class="keyword">if</span>(x==<span class="number">1</span>)<span class="keyword">return</span>;</span><br><span class="line">	dfs(x-(x&gt;&gt;<span class="number">1</span>)),dfs(x&gt;&gt;<span class="number">1</span>);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	ll x;</span><br><span class="line">	<span class="keyword">int</span> tot;</span><br><span class="line">	<span class="keyword">for</span>(ri tt=read();tt;--tt){</span><br><span class="line">		x=readl();</span><br><span class="line">		vl.clear();</span><br><span class="line">		vs.clear();</span><br><span class="line">		dfs(x);</span><br><span class="line">		sort(vl.begin(),vl.end());</span><br><span class="line">		idx.clear();</span><br><span class="line">		tot=<span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;vl.size();++i)idx[vl[i]]=++tot;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;tot+<span class="number">1</span>&lt;&lt;<span class="string">&apos;\n&apos;</span>;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="number">-1</span>&lt;&lt;<span class="string">&apos; &apos;</span>&lt;&lt;<span class="number">-1</span>&lt;&lt;<span class="string">&apos;\n&apos;</span>;</span><br><span class="line">		<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;vl.size();++i)<span class="built_in">cout</span>&lt;&lt;idx[vl[i]-(vl[i]&gt;&gt;<span class="number">1</span>)]&lt;&lt;<span class="string">&apos; &apos;</span>&lt;&lt;idx[vl[i]&gt;&gt;<span class="number">1</span>]&lt;&lt;<span class="string">&apos;\n&apos;</span>;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;idx[vl.back()]&lt;&lt;<span class="string">&apos;\n&apos;</span>;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="fascination-street"><a class="markdownIt-Anchor" href="#fascination-street"></a> <a href="https://codeforces.com/gym/102059/problem/G" target="_blank" rel="noopener">Fascination Street</a></h2>
<p>&#x9898;&#x610F;&#x7B80;&#x8FF0;&#xFF1A;</p>
<blockquote>
<p>&#x8857;&#x9053;&#x4E0A;&#x6709;&#x4E00;&#x6392;&#x706F;&#xFF0C;&#x4E00;&#x5F00;&#x59CB;&#x5168;&#x706D;&#xFF0C;&#x70B9;&#x4EAE;&#x6BCF;&#x76CF;&#x706F;&#x6709;&#x4E00;&#x5B9A;&#x4EE3;&#x4EF7;&#xFF0C;&#x8981;&#x6C42;&#x6700;&#x540E;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x4F4D;&#x7F6E;&#x8DDD;&#x79BB;&#x81EA;&#x5DF1;&#x4E0D;&#x8D85;&#x8FC7; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> &#x7684;&#x706F;&#x81F3;&#x5C11;&#x70B9;&#x4EAE;&#x4E00;&#x76CF;&#x3002;&#x9664;&#x6B64;&#x4E4B;&#x5916;&#xFF0C;&#x6709; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> &#x6B21;&#x673A;&#x4F1A;&#x4EA4;&#x6362;&#x4E24;&#x76CF;&#xFF0C;&#x95EE;&#x6700;&#x5C0F;&#x4EE3;&#x4EF7;&#x3002;</p>
</blockquote>
<p>&#x6570;&#x636E;&#x8303;&#x56F4;&#xFF1A;</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>&#x2264;</mo><mn>250000</mn><mo separator="true">,</mo><mi>k</mi><mo>&#x2264;</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">n\le250000,k\le9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2264;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mord">5</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2264;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">9</span></span></span></span></li>
</ul>
<p>&#x89E3;&#x9898;&#x601D;&#x8DEF;&#xFF1A;</p>
<blockquote>
<p>&#x4E00;&#x9053;&#x6BD4;&#x8F83;&#x6709;&#x610F;&#x601D;&#x7684;&#x4E8F;&#x6B20;&#x578B; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">dp</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span></span></span></span> &#xFF0C;&#x8003;&#x8651;&#x5230;&#x4EA4;&#x6362;&#x7684;&#x4E00;&#x5B9A;&#x662F;&#x4E00;&#x76CF;&#x4EAE;&#x7684;&#x548C;&#x4E00;&#x76CF;&#x706D;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x72B6;&#x6001; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">/</mi><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">/</mi><mn>1</mn><mo separator="true">,</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{i,0/1,0/1,x,y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04964em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span><span class="mord mtight">/</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span><span class="mord mtight">/</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span> &#x8868;&#x793A;&#x8003;&#x8651;&#x5230;&#x7B2C; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> &#x76CF;&#x706F;&#xFF0C;&#x6700;&#x540E;&#x4E24;&#x76CF;&#x706F;&#x7684;&#x4EAE;&#x706D;&#x72B6;&#x6001;&#xFF0C;&#x73B0;&#x5728;&#x5DF2;&#x7ECF;&#x6362;&#x4E86; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> &#x76CF;&#x4EAE;&#x7684;&#x706F;&#xFF0C; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> &#x76CF;&#x706D;&#x7684;&#x706F;&#xFF0C;&#x7136;&#x540E;&#x679A;&#x4E3E;&#x5F53;&#x524D;&#x706F;&#x4EAE;&#x4E0D;&#x4EAE;&#xFF0C;&#x6362;&#x4E0D;&#x6362;&#x5373;&#x53EF;</p>
</blockquote>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc getchar</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))f^=ch==<span class="string">&apos;-&apos;</span>,ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> f?ans:-ans;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">250005</span>;</span><br><span class="line"><span class="keyword">int</span> n,K,vl[N],cur=<span class="number">0</span>;</span><br><span class="line">ll f[<span class="number">2</span>][<span class="number">2</span>][<span class="number">2</span>][<span class="number">10</span>][<span class="number">10</span>],inf;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmin</span><span class="params">(ll&amp;x,ll y)</span></span>{x=x&lt;y?x:y;}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read(),K=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)vl[i]=read();</span><br><span class="line">	<span class="built_in">memset</span>(f[cur=<span class="number">0</span>],<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(f[<span class="number">0</span>]));</span><br><span class="line">	inf=f[cur][<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>],f[cur][<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">	ll t;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;n;++i){</span><br><span class="line">		<span class="built_in">memset</span>(f[cur^<span class="number">1</span>],<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(f[cur^<span class="number">1</span>]));</span><br><span class="line">		<span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;<span class="number">2</span>;++j)<span class="keyword">for</span>(ri k=<span class="number">0</span>;k&lt;<span class="number">2</span>;++k)<span class="keyword">for</span>(ri a=<span class="number">0</span>;a&lt;=K;++a)<span class="keyword">for</span>(ri b=<span class="number">0</span>;b&lt;=K;++b){</span><br><span class="line">			<span class="keyword">if</span>(f[cur][j][k][a][b]==inf)<span class="keyword">continue</span>;</span><br><span class="line">			t=f[cur][j][k][a][b];</span><br><span class="line">			ckmin(f[cur^<span class="number">1</span>][k][<span class="number">1</span>][a][b],t+vl[i+<span class="number">1</span>]);</span><br><span class="line">			<span class="keyword">if</span>(j|k)ckmin(f[cur^<span class="number">1</span>][k][<span class="number">0</span>][a][b],t);</span><br><span class="line">			<span class="keyword">if</span>(a&lt;K)ckmin(f[cur^<span class="number">1</span>][k][<span class="number">1</span>][a+<span class="number">1</span>][b],t);</span><br><span class="line">			<span class="keyword">if</span>(b&lt;K&amp;&amp;(j|k))ckmin(f[cur^<span class="number">1</span>][k][<span class="number">0</span>][a][b+<span class="number">1</span>],t+vl[i+<span class="number">1</span>]);</span><br><span class="line">		}</span><br><span class="line">		cur^=<span class="number">1</span>;</span><br><span class="line">	}</span><br><span class="line">	ll ans=inf;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;<span class="number">2</span>;++i)<span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;<span class="number">2</span>;++j)<span class="keyword">for</span>(ri k=<span class="number">0</span>;k&lt;=K;++k)<span class="keyword">if</span>(i|j)ckmin(ans,f[cur][i][j][k][k]);</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;ans;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="fractions"><a class="markdownIt-Anchor" href="#fractions"></a> <a href="https://codeforces.com/gym/102059/problem/H" target="_blank" rel="noopener">Fractions</a></h2>
<p>&#x66B4;&#x529B;&#x679A;&#x4E3E;&#x5373;&#x53EF;</p>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc getchar</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))f^=ch==<span class="string">&apos;-&apos;</span>,ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> f?ans:-ans;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (a+=b)&lt;mod?a:a-mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (a-=b)&lt;<span class="number">0</span>?a+mod:a;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (ll)a*b%mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{(a+=b)&lt;mod?a:(a-=mod);}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{(a-=b)&lt;<span class="number">0</span>?(a+=mod):a;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=(ll)a*b%mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>{<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))<span class="keyword">if</span>(p&amp;<span class="number">1</span>)Mul(ret,a);<span class="keyword">return</span> ret;}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	ll a,b,c,d,xl,xr,yl,yr,ans=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;a&gt;&gt;b&gt;&gt;c&gt;&gt;d;</span><br><span class="line">	<span class="keyword">for</span>(ri j,i=<span class="number">1</span>;i&lt;=<span class="number">1000</span>;++i){</span><br><span class="line">		j=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(;;++j){</span><br><span class="line">			<span class="keyword">if</span>(__gcd(i,j)!=<span class="number">1</span>)<span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span>(i+j&gt;=<span class="number">1000</span>)<span class="keyword">break</span>;</span><br><span class="line">			xl=a%i?a/i+<span class="number">1</span>:a/i,xr=b/i;</span><br><span class="line">			yl=c%j?c/j+<span class="number">1</span>:c/j,yr=d/j;</span><br><span class="line">			<span class="keyword">if</span>(max(xl,yl)&lt;=min(xr,yr))ans+=min(xr,yr)-max(xl,yl)+<span class="number">1</span>;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;ans;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="game-on-plane"><a class="markdownIt-Anchor" href="#game-on-plane"></a> <a href="https://codeforces.com/gym/102059/problem/I" target="_blank" rel="noopener">Game on Plane</a></h2>
<p>&#x6309;&#x7167;&#x9898;&#x610F;&#x679A;&#x4E3E;&#x65AD;&#x8FB9;&#xFF0C;&#x53D1;&#x73B0;&#x5269;&#x4E0B;&#x4E24;&#x4E2A;&#x6210;&#x4E86;&#x5B50;&#x95EE;&#x9898;&#xFF0C;&#x4E8E;&#x662F;&#x7528; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>G</mi></mrow><annotation encoding="application/x-tex">SG</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">G</span></span></span></span> &#x51FD;&#x6570;&#x5373;&#x53EF;</p>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc getchar</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))f^=ch==<span class="string">&apos;-&apos;</span>,ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> f?ans:-ans;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (a+=b)&lt;mod?a:a-mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (a-=b)&lt;<span class="number">0</span>?a+mod:a;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (ll)a*b%mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{(a+=b)&lt;mod?a:(a-=mod);}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{(a-=b)&lt;<span class="number">0</span>?(a+=mod):a;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=(ll)a*b%mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>{<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))<span class="keyword">if</span>(p&amp;<span class="number">1</span>)Mul(ret,a);<span class="keyword">return</span> ret;}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">5005</span>;</span><br><span class="line"><span class="keyword">int</span> n,a[N],sg[N];</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>{</span><br><span class="line">	sg[<span class="number">2</span>]=sg[<span class="number">3</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">4</span>;i&lt;=<span class="number">5000</span>;++i){</span><br><span class="line">		<span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line">		<span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;=i<span class="number">-2</span>;++j)vis[sg[j]^sg[i<span class="number">-2</span>-j]]=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(ri j=<span class="number">0</span>;;++j)<span class="keyword">if</span>(!vis[j]){sg[i]=j;<span class="keyword">break</span>;}</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	init();</span><br><span class="line">	<span class="keyword">for</span>(ri tt=read();tt;--tt)<span class="built_in">puts</span>(sg[read()]?<span class="string">&quot;First&quot;</span>:<span class="string">&quot;Second&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="histogram-sequence"><a class="markdownIt-Anchor" href="#histogram-sequence"></a> <a href="https://codeforces.com/gym/102059/problem/J" target="_blank" rel="noopener">Histogram Sequence</a></h2>
<p>&#x4E8C;&#x5206;+&#x5355;&#x8C03;&#x6808;+&#x5806;&#x5373;&#x53EF;</p>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> rlen=<span class="number">1</span>&lt;&lt;<span class="number">18</span>|<span class="number">1</span>;</span><br><span class="line"><span class="keyword">char</span> buf[rlen],*ib=buf,*ob=buf;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc() (((ib==ob)&amp;&amp;(ob=(ib=buf)+fread(buf,1,rlen,stdin)),ib==ob)?-1:*ib++)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,ll&gt; pll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,<span class="keyword">int</span>&gt; pli;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> uii;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> Ull;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; poly;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">readl</span><span class="params">()</span></span>{</span><br><span class="line">	ll ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Read</span><span class="params">(<span class="keyword">char</span>*s)</span></span>{</span><br><span class="line">	<span class="keyword">int</span> top=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(ch!=<span class="string">&apos;O&apos;</span>&amp;&amp;ch!=<span class="string">&apos;#&apos;</span>&amp;&amp;ch!=<span class="string">&apos;.&apos;</span>&amp;&amp;ch!=<span class="string">&apos;*&apos;</span>)ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(ch==<span class="string">&apos;O&apos;</span>||ch==<span class="string">&apos;#&apos;</span>||ch==<span class="string">&apos;.&apos;</span>||ch==<span class="string">&apos;*&apos;</span>)s[++top]=ch,ch=gc();</span><br><span class="line">	<span class="keyword">return</span> top;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">namespace</span> modular{</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">998244353</span>,inv2=<span class="number">499122177</span>;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> a+b&lt;mod?a+b:a+b-mod;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> a-b&lt;<span class="number">0</span>?a-b+mod:a-b;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (ll)a*b%mod;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=add(a,b);}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=dec(a,b);}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=(ll)a*b%mod;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>{<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))(p&amp;<span class="number">1</span>)&amp;&amp;(Mul(ret,a),<span class="number">1</span>);<span class="keyword">return</span> ret;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> a)</span></span>{<span class="keyword">return</span> ksm(a,mod<span class="number">-2</span>);}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">fix</span><span class="params">(<span class="keyword">int</span>&amp;a)</span></span>{a=(a%mod+mod)%mod;}</span><br><span class="line">}</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> modular;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmax</span><span class="params">(T&amp;a,T b)</span></span>{a&lt;b?a=b:<span class="number">0</span>;}</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmin</span><span class="params">(T&amp;a,T b)</span></span>{a&gt;b?a=b:<span class="number">0</span>;}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">300005</span>;</span><br><span class="line"><span class="keyword">int</span> n,a[N],pl[N],pr[N],stk[N],tp;</span><br><span class="line">ll L,R;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>{</span><br><span class="line">	stk[tp=<span class="number">1</span>]=pl[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">2</span>;i&lt;=n;++i){</span><br><span class="line">		<span class="keyword">while</span>(tp&amp;&amp;a[stk[tp]]&gt;=a[i])--tp;</span><br><span class="line">		pl[i]=stk[tp]+<span class="number">1</span>;</span><br><span class="line">		stk[++tp]=i;</span><br><span class="line">	}</span><br><span class="line">	stk[<span class="number">0</span>]=n+<span class="number">1</span>;</span><br><span class="line">	stk[tp=<span class="number">1</span>]=pr[n]=n;</span><br><span class="line">	<span class="keyword">for</span>(ri i=n<span class="number">-1</span>;i;--i){</span><br><span class="line">		<span class="keyword">while</span>(tp&amp;&amp;a[stk[tp]]&gt;a[i])--tp;</span><br><span class="line">		pr[i]=stk[tp]<span class="number">-1</span>;</span><br><span class="line">		stk[++tp]=i;</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">calc</span><span class="params">(ll lm,ll len)</span></span>{</span><br><span class="line">	ll s=max(<span class="number">1l</span>l,len-lm+<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> (len+s)*(len-s+<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">calc</span><span class="params">(ll lm)</span></span>{</span><br><span class="line">	ll res=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i){</span><br><span class="line">		<span class="keyword">if</span>(a[i]&gt;lm)<span class="keyword">continue</span>;</span><br><span class="line">		res+=calc(lm/a[i],pr[i]-pl[i]+<span class="number">1</span>)-calc(lm/a[i],pr[i]-i)-calc(lm/a[i],i-pl[i]);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> len)</span></span>{</span><br><span class="line">	<span class="keyword">return</span> max((r-l+<span class="number">1</span>)-len+<span class="number">1</span>,<span class="number">0l</span>l)-max((r-p)-len+<span class="number">1</span>,<span class="number">0l</span>l)-max((p-l)-len+<span class="number">1</span>,<span class="number">0l</span>l);</span><br><span class="line">}</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>{</span></span><br><span class="line">	ll h,w;</span><br><span class="line">	<span class="keyword">int</span> id;</span><br><span class="line">	Node(ll h=<span class="number">0</span>,ll w=<span class="number">0</span>,<span class="keyword">int</span> id=<span class="number">0</span>):h(h),w(w),id(id){}</span><br><span class="line">	<span class="keyword">friend</span> <span class="keyword">inline</span> <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(Node a,Node b){<span class="keyword">return</span> a.h*a.w&gt;b.h*b.w;}</span><br><span class="line">}tmp;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)a[i]=read();</span><br><span class="line">	L=readl(),R=readl();</span><br><span class="line">	init();</span><br><span class="line">	ll l=<span class="number">0</span>,r=<span class="number">1e18</span>,res=<span class="number">1e18</span>;</span><br><span class="line">	<span class="keyword">while</span>(l&lt;=r){</span><br><span class="line">		ll mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(calc(mid)&gt;=L)r=mid<span class="number">-1</span>,res=mid;</span><br><span class="line">		<span class="keyword">else</span> l=mid+<span class="number">1</span>;</span><br><span class="line">	}</span><br><span class="line">	ll lm=calc(res);</span><br><span class="line">	<span class="keyword">while</span>(L&lt;=R&amp;&amp;L&lt;=lm){</span><br><span class="line">		++L;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;res&lt;&lt;<span class="string">&apos; &apos;</span>;</span><br><span class="line">	}</span><br><span class="line">	priority_queue&lt;Node&gt;q;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)q.push(Node(a[i],res/a[i]+<span class="number">1</span>,i));</span><br><span class="line">	<span class="keyword">while</span>(L&lt;=R){</span><br><span class="line">		tmp=q.top();</span><br><span class="line">		q.pop();</span><br><span class="line">		<span class="keyword">int</span> num=calc(tmp.id,pl[tmp.id],pr[tmp.id],tmp.w);</span><br><span class="line">		<span class="keyword">if</span>(!num)<span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">while</span>(num&amp;&amp;L&lt;=R){</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;tmp.h*tmp.w&lt;&lt;<span class="string">&apos; &apos;</span>;</span><br><span class="line">			++L;</span><br><span class="line">			--num;</span><br><span class="line">		}</span><br><span class="line">		++tmp.w;</span><br><span class="line">		q.push(tmp);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="interesting-drug"><a class="markdownIt-Anchor" href="#interesting-drug"></a> <a href="https://codeforces.com/gym/102059/problem/K" target="_blank" rel="noopener">Interesting Drug</a></h2>
<p>&#x9898;&#x610F;&#x7B80;&#x8FF0;&#xFF1A;</p>
<blockquote>
<p>&#x4E00;&#x6761;&#x8DEF;&#x4E0A;&#x6309;&#x987A;&#x5E8F;&#x6709; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> &#x74F6;&#x6BD2;&#x836F;&#xFF0C;&#x5BF9;&#x4E8E; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>&#x2208;</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">i&#x2208;[1,n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2208;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">]</span></span></span></span> &#xFF0C;&#x6C42;&#x51FA;&#x5982;&#x4E0B;&#x7684;&#x503C;&#xFF1A;&#x4ECE; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> &#x51FA;&#x53D1;&#xFF0C;&#x6BCF;&#x4E2A;&#x65F6;&#x523B;&#x5403;&#x6389;&#x5F53;&#x524D;&#x4F4D;&#x7F6E;&#x7684;&#x6BD2;&#x836F;&#xFF0C;&#x7136;&#x540E;&#x9009;&#x62E9;&#x4E0B;&#x4E00;&#x6B65;&#x5403;&#x5DE6;&#x6216;&#x53F3;&#x7684;&#x6BD2;&#x836F;&#xFF0C;&#x5C06;&#x6BCF;&#x6B21;&#x9009;&#x62E9;&#x7684;&#x4F4D;&#x7F6E;&#x641E;&#x6210;&#x4E00;&#x4E2A;&#x6392;&#x5217; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> &#xFF0C;&#x5176;&#x4F24;&#x5BB3;&#x5B9A;&#x4E49;&#x4E3A; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>&#x2211;</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>d</mi><mi>j</mi></msub><mo stretchy="false">[</mo><msub><mi>p</mi><msub><mi>c</mi><mi>j</mi></msub></msub><mo>=</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\sum\limits_{j=1}^nd_j[p_{c_j}=j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.465174em;vertical-align:-1.113777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3513970000000004em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">&#x2211;</span></span></span><span style="top:-3.950005em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.113777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.34731999999999996em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span> &#xFF0C;&#x6C42;&#x53EF;&#x80FD;&#x7684;&#x6392;&#x5217;&#x4E2D;&#x6700;&#x5927;&#x7684;&#x4F24;&#x5BB3;&#x503C;&#x3002;</p>
</blockquote>
<p>&#x6570;&#x636E;&#x8303;&#x56F4;&#xFF1A;</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>&#x2264;</mo><mn>3</mn><mo>&#xD7;</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">n\le3\times10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2264;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#xD7;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
<p>&#x89E3;&#x9898;&#x601D;&#x8DEF;&#xFF1A;</p>
<blockquote>
<p>&#x5BB9;&#x6613;&#x770B;&#x51FA;&#x4E00;&#x4E2A; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">dp</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span></span></span></span> &#x5373; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> &#x8868;&#x793A;&#x5DF2;&#x7ECF;&#x5403;&#x6389;&#x533A;&#x95F4; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[i,j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span> &#x7684;&#x6BD2;&#x836F;&#x5230;&#x5403;&#x5B8C;&#x7684;&#x6700;&#x5927;&#x503C;&#xFF0C;&#x8FD9;&#x6837;&#x653E;&#x5230;&#x4E8C;&#x7EF4;&#x5E73;&#x9762;&#x4E0A;&#x6BCF;&#x6B21;&#x8F6C;&#x79FB;&#x5BF9;&#x5E94;&#x5411;&#x4E0B;&#x6216;&#x8005;&#x5411;&#x53F3;&#x8D70;&#xFF0C;&#x800C;&#x7531;&#x4E8E;&#x6700;&#x591A;&#x6709; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">2n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathdefault">n</span></span></span></span> &#x6761;&#x8F6C;&#x79FB;&#x8FB9;&#xFF0C;&#x56E0;&#x6B64;&#x679A;&#x4E3E;&#x7EB5;&#x5750;&#x6807;&#xFF0C;&#x7528;&#x6811;&#x72B6;&#x6570;&#x7EC4;&#x4FEE;&#x6539;&#x540E;&#x7F00;&#x53D6; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">max</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span></span></span></span> &#x548C;&#x67E5;&#x8BE2;&#x524D;&#x7F00; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">max</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span></span></span></span> &#x5373;&#x53EF;</p>
</blockquote>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> rlen=<span class="number">1</span>&lt;&lt;<span class="number">18</span>|<span class="number">1</span>;</span><br><span class="line"><span class="keyword">char</span> buf[rlen],*ib=buf,*ob=buf;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc() (((ib==ob)&amp;&amp;(ob=(ib=buf)+fread(buf,1,rlen,stdin)),ib==ob)?-1:*ib++)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,ll&gt; pll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,<span class="keyword">int</span>&gt; pli;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> uii;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> Ull;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; poly;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">readl</span><span class="params">()</span></span>{</span><br><span class="line">	ll ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Read</span><span class="params">(<span class="keyword">char</span>*s)</span></span>{</span><br><span class="line">	<span class="keyword">int</span> top=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(ch!=<span class="string">&apos;O&apos;</span>&amp;&amp;ch!=<span class="string">&apos;#&apos;</span>&amp;&amp;ch!=<span class="string">&apos;.&apos;</span>&amp;&amp;ch!=<span class="string">&apos;*&apos;</span>)ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(ch==<span class="string">&apos;O&apos;</span>||ch==<span class="string">&apos;#&apos;</span>||ch==<span class="string">&apos;.&apos;</span>||ch==<span class="string">&apos;*&apos;</span>)s[++top]=ch,ch=gc();</span><br><span class="line">	<span class="keyword">return</span> top;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">namespace</span> modular{</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">998244353</span>,inv2=<span class="number">499122177</span>;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> a+b&lt;mod?a+b:a+b-mod;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> a-b&lt;<span class="number">0</span>?a-b+mod:a-b;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (ll)a*b%mod;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=add(a,b);}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=dec(a,b);}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=(ll)a*b%mod;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>{<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))(p&amp;<span class="number">1</span>)&amp;&amp;(Mul(ret,a),<span class="number">1</span>);<span class="keyword">return</span> ret;}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> a)</span></span>{<span class="keyword">return</span> ksm(a,mod<span class="number">-2</span>);}</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">fix</span><span class="params">(<span class="keyword">int</span>&amp;a)</span></span>{a=(a%mod+mod)%mod;}</span><br><span class="line">}</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> modular;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmax</span><span class="params">(T&amp;a,T b)</span></span>{a&lt;b?a=b:<span class="number">0</span>;}</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ckmin</span><span class="params">(T&amp;a,T b)</span></span>{a&gt;b?a=b:<span class="number">0</span>;}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">3e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,c[N],d[N];</span><br><span class="line">ll bit[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span></span>{<span class="keyword">return</span> x&amp;-x;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x,ll v)</span></span>{<span class="keyword">for</span>(;x;x^=lowbit(x))ckmax(bit[x],v);}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> x)</span></span>{ll res=<span class="number">0</span>;<span class="keyword">for</span>(;x&lt;=n;x+=lowbit(x))ckmax(res,bit[x]);<span class="keyword">return</span> res;}</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;ps[N];</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i){</span><br><span class="line">		c[i]=read();</span><br><span class="line">		<span class="keyword">if</span>(c[i]!=<span class="number">1</span>&amp;&amp;c[i]&lt;=i)ps[i-c[i]+<span class="number">1</span>].pb(i);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)d[i]=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i){</span><br><span class="line">		<span class="keyword">for</span>(ri j=(<span class="keyword">int</span>)ps[i].size()<span class="number">-1</span>;~j;--j)		</span><br><span class="line">		update(ps[i][j]<span class="number">-1</span>,query(ps[i][j])+d[ps[i][j]]);</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;query(i)+(c[i]==<span class="number">1</span>?d[i]:<span class="number">0</span>)&lt;&lt;<span class="string">&apos; &apos;</span>;</span><br><span class="line">		<span class="keyword">if</span>(i+c[i]<span class="number">-1</span>&lt;=n)update(i+c[i]<span class="number">-1</span>,query(i+c[i]<span class="number">-1</span>)+d[i]);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details> 
<hr>
<h2 id="timsort"><a class="markdownIt-Anchor" href="#timsort"></a> <a href="https://codeforces.com/gym/102059/problem/L" target="_blank" rel="noopener">Timsort</a></h2>
<p>&#x76F4;&#x63A5;&#x66B4;&#x529B;&#x5373;&#x53EF;&#xFF0C;&#x590D;&#x6742;&#x5EA6;&#x662F;&#x8C03;&#x548C;&#x7EA7;&#x6570;</p>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc getchar</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))f^=ch==<span class="string">&apos;-&apos;</span>,ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> f?ans:-ans;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (a+=b)&lt;mod?a:a-mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (a-=b)&lt;<span class="number">0</span>?a+mod:a;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{<span class="keyword">return</span> (ll)a*b%mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{(a+=b)&lt;mod?a:(a-=mod);}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{(a-=b)&lt;<span class="number">0</span>?(a+=mod):a;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span></span>{a=(ll)a*b%mod;}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>{<span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a))<span class="keyword">if</span>(p&amp;<span class="number">1</span>)Mul(ret,a);<span class="keyword">return</span> ret;}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,a[N],f[N][<span class="number">2</span>];</span><br><span class="line">pii ans[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)a[i]=read();</span><br><span class="line">	f[n][<span class="number">0</span>]=f[n][<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ri i=n<span class="number">-1</span>;i;--i){</span><br><span class="line">		f[i][<span class="number">0</span>]=a[i]&lt;=a[i+<span class="number">1</span>]?f[i+<span class="number">1</span>][<span class="number">0</span>]+<span class="number">1</span>:<span class="number">1</span>;</span><br><span class="line">		f[i][<span class="number">1</span>]=a[i]&gt;a[i+<span class="number">1</span>]?f[i+<span class="number">1</span>][<span class="number">1</span>]+<span class="number">1</span>:<span class="number">1</span>;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span>(ri tt=read(),len;tt;--tt){</span><br><span class="line">		len=read();</span><br><span class="line">		<span class="keyword">if</span>(ans[len].fi)<span class="built_in">cout</span>&lt;&lt;ans[len].fi&lt;&lt;<span class="string">&apos; &apos;</span>&lt;&lt;ans[len].se&lt;&lt;<span class="string">&apos;\n&apos;</span>;</span><br><span class="line">		<span class="keyword">else</span>{</span><br><span class="line">			<span class="keyword">for</span>(ri t,i=<span class="number">1</span>;i&lt;=n;++i){</span><br><span class="line">				++ans[len].fi;</span><br><span class="line">				<span class="keyword">if</span>(f[i][<span class="number">0</span>]&gt;=len){</span><br><span class="line">					i+=f[i][<span class="number">0</span>]<span class="number">-1</span>;</span><br><span class="line">					<span class="keyword">continue</span>;</span><br><span class="line">				}</span><br><span class="line">				<span class="keyword">if</span>(f[i][<span class="number">1</span>]&gt;=len){</span><br><span class="line">					i+=f[i][<span class="number">1</span>]<span class="number">-1</span>;</span><br><span class="line">					<span class="keyword">continue</span>;</span><br><span class="line">				}</span><br><span class="line">				t=max(f[i][<span class="number">0</span>],f[i][<span class="number">1</span>]);</span><br><span class="line">				ans[len].se+=min(n-i+<span class="number">1</span>-t,len-t);</span><br><span class="line">				i+=min(n-i+<span class="number">1</span>,len)<span class="number">-1</span>;</span><br><span class="line">			}</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;ans[len].fi&lt;&lt;<span class="string">&apos; &apos;</span>&lt;&lt;ans[len].se&lt;&lt;<span class="string">&apos;\n&apos;</span>;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="utilitarianism"><a class="markdownIt-Anchor" href="#utilitarianism"></a> <a href="https://codeforces.com/gym/102059/problem/M" target="_blank" rel="noopener">Utilitarianism</a></h2>
<p>&#x76F4;&#x63A5;&#x7528; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi><mi>q</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">wqs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mord mathdefault">s</span></span></span></span> &#x4E8C;&#x5206;+&#x7B80;&#x5355;&#x6811;&#x5F62; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">dp</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span></span></span></span> &#x5373;&#x53EF;</p>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> rlen=<span class="number">1</span>&lt;&lt;<span class="number">18</span>|<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">gc</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">char</span> buf[rlen],*ib,*ob;</span><br><span class="line">	(ib==ob)&amp;&amp;(ob=(ib=buf)+fread(buf,<span class="number">1</span>,rlen,<span class="built_in">stdin</span>));</span><br><span class="line">	<span class="keyword">return</span> ib==ob?<span class="number">-1</span>:*ib++;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch))f^=ch==<span class="string">&apos;-&apos;</span>,ch=gc();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">	<span class="keyword">return</span> f?ans:-ans;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">250005</span>;</span><br><span class="line"><span class="keyword">int</span> n,k;</span><br><span class="line"><span class="built_in">vector</span>&lt;pii&gt;e[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dat</span>{</span></span><br><span class="line">	ll a;</span><br><span class="line">	<span class="keyword">int</span> b;</span><br><span class="line">	dat(ll a=<span class="number">0</span>,<span class="keyword">int</span> b=<span class="number">0</span>):a(a),b(b){}</span><br><span class="line">	<span class="keyword">friend</span> <span class="keyword">inline</span> dat <span class="keyword">operator</span>+(<span class="keyword">const</span> dat&amp;a,<span class="keyword">const</span> dat&amp;b){<span class="keyword">return</span> dat(a.a+b.a,a.b+b.b);}</span><br><span class="line">	<span class="keyword">friend</span> <span class="keyword">inline</span> dat <span class="keyword">operator</span>-(<span class="keyword">const</span> dat&amp;a,<span class="keyword">const</span> dat&amp;b){<span class="keyword">return</span> dat(a.a-b.a,a.b-b.b);}</span><br><span class="line">	<span class="keyword">friend</span> <span class="keyword">inline</span> <span class="keyword">bool</span> <span class="keyword">operator</span>&gt;(<span class="keyword">const</span> dat&amp;a,<span class="keyword">const</span> dat&amp;b){<span class="keyword">return</span> a.a==b.a?a.b&gt;b.b:a.a&gt;b.a;}</span><br><span class="line">}f[N][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> dat <span class="title">max</span><span class="params">(<span class="keyword">const</span> dat&amp;a,<span class="keyword">const</span> dat&amp;b)</span></span>{<span class="keyword">return</span> a&gt;b?a:b;}</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> fa,ll tmp)</span></span>{</span><br><span class="line">	f[p][<span class="number">0</span>]=f[p][<span class="number">1</span>]=dat(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>,v;i&lt;e[p].size();++i){</span><br><span class="line">		<span class="keyword">if</span>((v=e[p][i].fi)==fa)<span class="keyword">continue</span>;</span><br><span class="line">		dfs(v,p,tmp),f[p][<span class="number">0</span>]=f[p][<span class="number">0</span>]+max(f[v][<span class="number">0</span>],f[v][<span class="number">1</span>]);</span><br><span class="line">	}</span><br><span class="line">	ll w;</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">0</span>,v;i&lt;e[p].size();++i){</span><br><span class="line">		<span class="keyword">if</span>((v=e[p][i].fi)==fa)<span class="keyword">continue</span>;</span><br><span class="line">		w=e[p][i].se+tmp;</span><br><span class="line">		f[p][<span class="number">1</span>]=max(f[p][<span class="number">1</span>],f[p][<span class="number">0</span>]-max(f[v][<span class="number">0</span>],f[v][<span class="number">1</span>])+f[v][<span class="number">0</span>]+dat(w,<span class="number">1</span>));</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">const</span> <span class="keyword">double</span> tmp)</span></span>{</span><br><span class="line">	dfs(<span class="number">1</span>,<span class="number">0</span>,tmp);</span><br><span class="line">	dat t=max(f[<span class="number">1</span>][<span class="number">0</span>],f[<span class="number">1</span>][<span class="number">1</span>]);</span><br><span class="line">	<span class="keyword">return</span> t.b&gt;=k;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">	freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	n=read(),k=read();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i)e[i].clear();</span><br><span class="line">	<span class="keyword">for</span>(ri i=<span class="number">1</span>,u,v,w;i&lt;n;++i){</span><br><span class="line">		u=read(),v=read(),w=read();</span><br><span class="line">		e[u].push_back(pii(v,w));</span><br><span class="line">		e[v].push_back(pii(u,w));</span><br><span class="line">	}</span><br><span class="line">	ll L=<span class="number">-1e14</span>,R=<span class="number">1e14</span>,ans=<span class="number">1e14</span>;</span><br><span class="line">	<span class="keyword">while</span>(L&lt;R){</span><br><span class="line">		ll mid=(L+R+<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">		<span class="keyword">if</span>(check(mid))ans=mid,R=mid<span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">else</span> L=mid+<span class="number">1</span>;</span><br><span class="line">	}</span><br><span class="line">	dfs(<span class="number">1</span>,<span class="number">0</span>,ans);</span><br><span class="line">	dat t=max(f[<span class="number">1</span>][<span class="number">0</span>],f[<span class="number">1</span>][<span class="number">1</span>]);</span><br><span class="line">	<span class="keyword">if</span>(t.b&lt;k)<span class="built_in">puts</span>(<span class="string">&quot;Impossible&quot;</span>);</span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">cout</span>&lt;&lt;(t.a-ans*k)&lt;&lt;<span class="string">&apos;\n&apos;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<p>&#x603B;&#x7ED3;&#xFF1A;</p>
<ul>
<li>&#x6211; <font color="red"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">dp</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span></span></span></span></font> &#x4E0D;&#x8FC7;&#x5173;</li>
<li>&#x6211;<font color="red"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x56FE;</mi><mi mathvariant="normal">&#x8BBA;</mi></mrow><annotation encoding="application/x-tex">&#x56FE;&#x8BBA;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x56FE;</span><span class="mord cjk_fallback">&#x8BBA;</span></span></span></span></font>&#x4E0D;&#x8FC7;&#x5173;</li>
<li>&#x6211;<font color="red"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x82F1;</mi><mi mathvariant="normal">&#x8BED;</mi></mrow><annotation encoding="application/x-tex">&#x82F1;&#x8BED;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x82F1;</span><span class="mord cjk_fallback">&#x8BED;</span></span></span></span></font>&#x4E0D;&#x8FC7;&#x5173;</li>
</ul>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">ldxcaicai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://xdl030112.github.io/gym102059/">http://xdl030112.github.io/gym102059/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%AF%94%E8%B5%9B%E9%A2%98%E8%A7%A3/">比赛题解    </a></div><div class="post_share"></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/sol1/"><img class="prev_cover lazyload" data-src="/img/cover.png" onerror="onerror=null;src='/img/cover.png'"><div class="label">Previous Post</div><div class="prev_info"><span>杂题乱做 Round1</span></div></a></div><div class="next-post pull_right"><a href="/191015test/"><img class="next_cover lazyload" data-src="/img/cover.png" onerror="onerror=null;src='/img/cover.png'"><div class="label">Next Post</div><div class="next_info"><span>2019.10.15 模拟测试题解</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> Recommend</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/CS6/" title="CS Academy Round 6 简要题解"><img class="relatedPosts_cover lazyload"data-src="/img/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-03</div><div class="relatedPosts_title">CS Academy Round 6 简要题解</div></div></a></div><div class="relatedPosts_item"><a href="/AGC039/" title="AtCoder Grand Contest 039 简要题解"><img class="relatedPosts_cover lazyload"data-src="/img/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-10-10</div><div class="relatedPosts_title">AtCoder Grand Contest 039 简要题解</div></div></a></div><div class="relatedPosts_item"><a href="/CF1244/" title="CodeForces 1244 简要题解"><img class="relatedPosts_cover lazyload"data-src="/img/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-10-14</div><div class="relatedPosts_title">CodeForces 1244 简要题解</div></div></a></div><div class="relatedPosts_item"><a href="/COJ70/" title="CometOJ模拟赛测试Day2 简要题解"><img class="relatedPosts_cover lazyload"data-src="/img/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-09-28</div><div class="relatedPosts_title">CometOJ模拟赛测试Day2 简要题解</div></div></a></div><div class="relatedPosts_item"><a href="/COJ69/" title="CometOJ模拟赛测试Day1 简要题解"><img class="relatedPosts_cover lazyload"data-src="/img/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-09-28</div><div class="relatedPosts_title">CometOJ模拟赛测试Day1 简要题解</div></div></a></div><div class="relatedPosts_item"><a href="/CF1228/" title="CodeForces 1228 简要题解"><img class="relatedPosts_cover lazyload"data-src="/img/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-10-12</div><div class="relatedPosts_title">CodeForces 1228 简要题解</div></div></a></div></div><div class="clear_both"></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By ldxcaicai</div><div class="framework-info"><span>Driven </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="Read Mode"></i><i class="fa fa-plus" id="font_plus" title="Increase font size"></i><i class="fa fa-minus" id="font_minus" title="Decrease font size"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="Traditional Chinese and Simplified Chinese Conversion" target="_self">简</a><i class="darkmode fa fa-moon-o" id="darkmode" title="Dark Mode"></i></div><div id="rightside-config-show"><div id="rightside_config" title="Setting"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="Table of Contents" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="Back to top" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>$(function () {
  $('span.katex-display').wrap('<div class="katex-wrap"></div>')
})</script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/ClickShowText.js"></script></body></html>