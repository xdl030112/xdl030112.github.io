<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>杂题乱做 Round13 | 自由を渇望する</title><meta name="description" content="杂题乱做 Round13"><meta name="keywords" content="题解"><meta name="author" content="ldxcaicai"><meta name="copyright" content="ldxcaicai"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/images/8.jpg"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="prev" title="CodeForces 1270 简要题解" href="http://xdl030112.github.io/CF1270/"><link rel="next" title="杂题乱做 Round12" href="http://xdl030112.github.io/sol12/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: true,
  copyright: undefined,
  ClickShowText: {"text":"zxyoi!,backseat_stargazer!,romiqi!,ldxcaicai==,jerome_wei!,dream_maker!,sjkmost!,buzhibujue!,hjk1030!,spacevortex!,jmr!,abuoluo2003!","fontSize":"15px"},
  medium_zoom: false,
  fancybox: false,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">自由を渇望する</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/ldxpig.jpg" onerror="onerror=null;src='/img/cover.png'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">37</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">3</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">2</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">Catalog</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#transforming-sequence"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text"> Transforming Sequence</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#&#x5C04;&#x547D;&#x4E38;&#x6587;&#x7684;&#x7B14;&#x8BB0;"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text"> &amp;#x5C04;&amp;#x547D;&amp;#x4E38;&amp;#x6587;&amp;#x7684;&amp;#x7B14;&amp;#x8BB0;</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#&#x8FB9;&#x53CC;&#x8FDE;&#x901A;&#x56FE;&#x8BA1;&#x6570;"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text"> &amp;#x8FB9;&amp;#x53CC;&amp;#x8FDE;&amp;#x901A;&amp;#x56FE;&amp;#x8BA1;&amp;#x6570;</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#&#x70B9;&#x53CC;&#x8FDE;&#x901A;&#x56FE;&#x8BA1;&#x6570;"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text"> &amp;#x70B9;&amp;#x53CC;&amp;#x8FDE;&amp;#x901A;&amp;#x56FE;&amp;#x8BA1;&amp;#x6570;</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#calc&#x52A0;&#x5F3A;&#x7248;"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text"> calc&amp;#x52A0;&amp;#x5F3A;&amp;#x7248;</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#&#x96C6;&#x5408;&#x5212;&#x5206;&#x8BA1;&#x6570;"><span class="toc_mobile_items-number">6.</span> <span class="toc_mobile_items-text"> &amp;#x96C6;&amp;#x5408;&amp;#x5212;&amp;#x5206;&amp;#x8BA1;&amp;#x6570;</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#wd&#x4E0E;&#x79EF;&#x6728;"><span class="toc_mobile_items-number">7.</span> <span class="toc_mobile_items-text"> WD&amp;#x4E0E;&amp;#x79EF;&amp;#x6728;</span></a></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#transforming-sequence"><span class="toc-number">1.</span> <span class="toc-text"> Transforming Sequence</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#&#x5C04;&#x547D;&#x4E38;&#x6587;&#x7684;&#x7B14;&#x8BB0;"><span class="toc-number">2.</span> <span class="toc-text"> &amp;#x5C04;&amp;#x547D;&amp;#x4E38;&amp;#x6587;&amp;#x7684;&amp;#x7B14;&amp;#x8BB0;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#&#x8FB9;&#x53CC;&#x8FDE;&#x901A;&#x56FE;&#x8BA1;&#x6570;"><span class="toc-number">3.</span> <span class="toc-text"> &amp;#x8FB9;&amp;#x53CC;&amp;#x8FDE;&amp;#x901A;&amp;#x56FE;&amp;#x8BA1;&amp;#x6570;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#&#x70B9;&#x53CC;&#x8FDE;&#x901A;&#x56FE;&#x8BA1;&#x6570;"><span class="toc-number">4.</span> <span class="toc-text"> &amp;#x70B9;&amp;#x53CC;&amp;#x8FDE;&amp;#x901A;&amp;#x56FE;&amp;#x8BA1;&amp;#x6570;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#calc&#x52A0;&#x5F3A;&#x7248;"><span class="toc-number">5.</span> <span class="toc-text"> calc&amp;#x52A0;&amp;#x5F3A;&amp;#x7248;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#&#x96C6;&#x5408;&#x5212;&#x5206;&#x8BA1;&#x6570;"><span class="toc-number">6.</span> <span class="toc-text"> &amp;#x96C6;&amp;#x5408;&amp;#x5212;&amp;#x5206;&amp;#x8BA1;&amp;#x6570;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wd&#x4E0E;&#x79EF;&#x6728;"><span class="toc-number">7.</span> <span class="toc-text"> WD&amp;#x4E0E;&amp;#x79EF;&amp;#x6728;</span></a></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(/img/cover.png)"><div id="post-info"><div id="post-title"><div class="posttitle">杂题乱做 Round13</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> Created 2019-12-28<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> Updated 2019-12-28</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/public/">public</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h2 id="transforming-sequence"><a class="markdownIt-Anchor" href="#transforming-sequence"></a> <a href="https://codeforces.com/contest/623/problem/E" target="_blank" rel="noopener">Transforming Sequence</a></h2>
<details><summary>&#x89E3;&#x9898;&#x601D;&#x8DEF;&#xFF1A;</summary>
<p>&#x9996;&#x5148;&#x5047;&#x5982; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>&gt;</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">n&gt;k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> &#x4E00;&#x5B9A;&#x4E0D;&#x5408;&#x6CD5;&#xFF0C;&#x90A3;&#x4E48;&#x5224;&#x65AD;&#x4E4B;&#x540E;&#x4E00;&#x5B9A;&#x6709; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>&#x2264;</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">n\le k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2264;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span></p>
<p>&#x8003;&#x8651;&#x8BBE; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> &#x8868;&#x793A;&#x524D; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> &#x4E2A;&#x6570;&#x5360;&#x7528;&#x4E86; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span> &#x4E2A;&#x6574;&#x6570;&#x4F4D;&#x7684;&#x65B9;&#x6848;&#x6570;&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x5217;&#x51FA;&#x8F6C;&#x79FB;&#x5F0F;&#xFF1A; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><munder><mo>&#x2211;</mo><mrow><mi>k</mi><mo>&#x2264;</mo><mi>j</mi></mrow></munder><msub><mi>f</mi><mrow><mi>i</mi><mo>&#x2212;</mo><mn>1</mn><mo separator="true">,</mo><mi>k</mi></mrow></msub><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mi>j</mi><mi>k</mi></mfrac><mo fence="true">)</mo></mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">f_{i,j}=\sum\limits_{k\le j}f_{i-1,k}\binom{j}{k}2^{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.043885em;vertical-align:-1.138221em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7500050000000001em;"><span style="top:-2.097887em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">&#x2264;</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">&#x2211;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.138221em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9056639999999999em;"><span style="top:-2.3550000000000004em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.144em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>&#x7136;&#x540E;&#x5C31;&#x53EF;&#x4EE5; dp &#x9012;&#x63A8;&#x5566;&#xFF01;</p>
<p>&#x7136;&#x540E;&#x4F60;&#x5C31; TLE &#x4E86;&#x3002;</p>
<p>&#x4ED4;&#x7EC6;&#x89C2;&#x5BDF;&#x53D1;&#x73B0;&#x8FD9;&#x4E2A;&#x8F6C;&#x79FB;&#x8DDF;&#x7B2C;&#x4E00;&#x7EF4;&#x5173;&#x7CFB;&#x4E0D;&#x5927;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x500D;&#x589E;&#x4F18;&#x5316; DP &#xFF0C;&#x5047;&#x8BBE; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>+</mo><mi>Y</mi><mo>=</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">X+Y=i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> &#x90A3;&#x4E48; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><munder><mo>&#x2211;</mo><mrow><mi>k</mi><mo>&lt;</mo><mi>j</mi></mrow></munder><msub><mi>f</mi><mrow><mi>X</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mi>j</mi><mi>k</mi></mfrac><mo fence="true">)</mo></mrow><msup><mn>2</mn><mrow><mi>k</mi><mi>X</mi></mrow></msup><msub><mi>f</mi><mrow><mi>Y</mi><mo separator="true">,</mo><mi>j</mi><mo>&#x2212;</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{i,j}=\sum\limits_{k&lt;j}f_{X,k}\binom{j}{k}2^{kX}f_{Y,j-k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.043885em;vertical-align:-1.138221em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7500050000000001em;"><span style="top:-2.097887em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">&lt;</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">&#x2211;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.138221em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9056639999999999em;"><span style="top:-2.3550000000000004em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.144em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">&#x2212;</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> &#xFF0C;&#x7136;&#x540E;&#x8FD9;&#x4E2A;&#x53EF;&#x4EE5;&#x76F4;&#x63A5; fft &#x641E;&#xFF0C;&#x7531;&#x4E8E;&#x6A21;&#x6570;&#x7684;&#x539F;&#x56E0;&#x83BD;&#x4E00;&#x53D1; mtt &#x5373;&#x53EF;</p>
</details>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; poly;</span><br><span class="line"><span class="keyword">namespace</span> modular {</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> a+b&lt;mod?a+b:a+b-mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> a&lt;b?a-b+mod:a-b; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> (ll)a*b%mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=a+b&lt;mod?a+b:a+b-mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=a&lt;b?a-b+mod:a-b; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=(ll)a*b%mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span> </span>{ <span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a)) (p&amp;<span class="number">1</span>)&amp;&amp;(Mul(ret,a),<span class="number">1</span>);<span class="keyword">return</span> ret; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> a)</span> </span>{ <span class="keyword">return</span> ksm(a,mod<span class="number">-2</span>); }</span><br><span class="line">}</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> modular;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">cp</span> {</span></span><br><span class="line">  <span class="keyword">double</span> x,y;</span><br><span class="line">  cp(<span class="keyword">double</span> x=<span class="number">0</span>,<span class="keyword">double</span> y=<span class="number">0</span>):x(x),y(y) {}</span><br><span class="line">  <span class="keyword">friend</span> <span class="keyword">inline</span> cp <span class="keyword">operator</span>+(cp a,cp b) { <span class="keyword">return</span> cp(a.x+b.x,a.y+b.y); }</span><br><span class="line">  <span class="keyword">friend</span> <span class="keyword">inline</span> <span class="keyword">void</span> <span class="keyword">operator</span>+=(cp&amp;a,cp b) { a=a+b; }</span><br><span class="line">  <span class="keyword">friend</span> <span class="keyword">inline</span> cp <span class="keyword">operator</span>-(cp a,cp b) { <span class="keyword">return</span> cp(a.x-b.x,a.y-b.y); }</span><br><span class="line">  <span class="keyword">friend</span> <span class="keyword">inline</span> <span class="keyword">void</span> <span class="keyword">operator</span>-=(cp&amp;a,cp b) { a=a-b; }</span><br><span class="line">  <span class="keyword">friend</span> <span class="keyword">inline</span> cp <span class="keyword">operator</span>*(cp a,cp b) { <span class="keyword">return</span> cp(a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x); }</span><br><span class="line">  <span class="keyword">friend</span> <span class="keyword">inline</span> <span class="keyword">void</span> <span class="keyword">operator</span>*=(cp&amp;a,cp b) { a=a*b; }</span><br><span class="line">  <span class="keyword">friend</span> <span class="keyword">inline</span> cp <span class="keyword">operator</span>*(cp a,<span class="keyword">double</span> b) { <span class="keyword">return</span> cp(a.x*b,a.y*b); }</span><br><span class="line">  <span class="keyword">friend</span> <span class="keyword">inline</span> <span class="keyword">void</span> <span class="keyword">operator</span>*=(cp&amp;a,<span class="keyword">double</span> b) { a=a*b; }</span><br><span class="line">  <span class="keyword">friend</span> <span class="keyword">inline</span> cp <span class="keyword">operator</span>/(cp a,<span class="keyword">double</span> b) { <span class="keyword">return</span> cp(a.x/b,a.y/b); }</span><br><span class="line">  <span class="keyword">friend</span> <span class="keyword">inline</span> <span class="keyword">void</span> <span class="keyword">operator</span>/=(cp&amp;a,<span class="keyword">double</span> b) { a=a/b; }</span><br><span class="line">  <span class="keyword">inline</span> cp <span class="keyword">operator</span>~() <span class="keyword">const</span> { <span class="keyword">return</span> cp(x,-y); }</span><br><span class="line">};</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;cp&gt; polyr;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> blo=(<span class="number">1</span>&lt;&lt;<span class="number">15</span>)<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> lim,tim;</span><br><span class="line"><span class="built_in">vector</span>&lt;cp&gt; w[<span class="number">20</span>];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; rev[<span class="number">20</span>];</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> pi=<span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init_fft</span><span class="params">()</span> </span>{</span><br><span class="line">  w[<span class="number">19</span>].resize(<span class="number">1</span>&lt;&lt;<span class="number">19</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>,lm=<span class="number">1</span>&lt;&lt;<span class="number">19</span>;i&lt;lm;++i) w[<span class="number">19</span>][i]=cp(<span class="built_in">cos</span>(pi/lm*i),<span class="built_in">sin</span>(pi/lm*i));</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">18</span>;~i;--i) {</span><br><span class="line">    w[i].resize(<span class="number">1</span>&lt;&lt;i);</span><br><span class="line">    <span class="keyword">for</span>(ri j=<span class="number">0</span>,lm=<span class="number">1</span>&lt;&lt;i;j&lt;lm;++j) w[i][j]=w[i+<span class="number">1</span>][j&lt;&lt;<span class="number">1</span>];</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> up)</span> </span>{</span><br><span class="line">  lim=<span class="number">1</span>,tim=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(lim&lt;up) lim&lt;&lt;=<span class="number">1</span>,++tim;</span><br><span class="line">  <span class="keyword">if</span>(rev[tim].size()) <span class="keyword">return</span>;</span><br><span class="line">  rev[tim].resize(lim);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;lim;++i) rev[tim][i]=(rev[tim][i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(tim<span class="number">-1</span>));</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">fft</span><span class="params">(polyr&amp;a,<span class="keyword">int</span> typ)</span> </span>{</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;lim;++i) <span class="keyword">if</span>(i&lt;rev[tim][i]) swap(a[i],a[rev[tim][i]]);</span><br><span class="line">  cp a0,a1;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>,t=<span class="number">0</span>;i&lt;lim;i&lt;&lt;=<span class="number">1</span>,++t) <span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;lim;j+=i&lt;&lt;<span class="number">1</span>) <span class="keyword">for</span>(ri k=<span class="number">0</span>;k&lt;i;++k) {</span><br><span class="line">    a0=a[j+k],a1=a[j+k+i]*w[t][k];</span><br><span class="line">    a[j+k]=a0+a1,a[j+k+i]=a0-a1;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span>(~typ) <span class="keyword">return</span>;</span><br><span class="line">  reverse(++a.begin(),a.end());</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;lim;++i) a[i]/=lim;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span>*(poly a,poly b) {</span><br><span class="line">  <span class="keyword">int</span> n=(<span class="keyword">int</span>)a.size(),m=(<span class="keyword">int</span>)b.size(),t=n+m<span class="number">-1</span>;</span><br><span class="line">  <span class="function">poly <span class="title">c</span><span class="params">(t)</span></span>;</span><br><span class="line">  init(t);</span><br><span class="line">  polyr A(lim),B(lim),P(lim),Q(lim);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;n;++i) A[i]=cp(a[i]&gt;&gt;<span class="number">15</span>,a[i]&amp;blo);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;m;++i) B[i]=cp(b[i]&gt;&gt;<span class="number">15</span>,b[i]&amp;blo);</span><br><span class="line">  fft(A,<span class="number">1</span>),fft(B,<span class="number">1</span>);</span><br><span class="line">  cp cur[<span class="number">4</span>];</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>,j=<span class="number">0</span>;i&lt;lim;++i,j=j?j<span class="number">-1</span>:lim<span class="number">-1</span>) {</span><br><span class="line">    cur[<span class="number">0</span>]=(A[i]+(~A[j]))*cp(<span class="number">0.5</span>,<span class="number">0</span>);</span><br><span class="line">    cur[<span class="number">1</span>]=((~A[j])-A[i])*cp(<span class="number">0</span>,<span class="number">0.5</span>);</span><br><span class="line">    cur[<span class="number">2</span>]=(B[i]+(~B[j]))*cp(<span class="number">0.5</span>,<span class="number">0</span>);</span><br><span class="line">    cur[<span class="number">3</span>]=((~B[j])-B[i])*cp(<span class="number">0</span>,<span class="number">0.5</span>);</span><br><span class="line">    P[i]=cur[<span class="number">0</span>]*cur[<span class="number">2</span>]+cp(<span class="number">0</span>,<span class="number">1</span>)*cur[<span class="number">1</span>]*cur[<span class="number">3</span>];</span><br><span class="line">    Q[i]=cur[<span class="number">0</span>]*cur[<span class="number">3</span>]+cp(<span class="number">0</span>,<span class="number">1</span>)*cur[<span class="number">1</span>]*cur[<span class="number">2</span>];</span><br><span class="line">  }</span><br><span class="line">  fft(P,<span class="number">-1</span>),fft(Q,<span class="number">-1</span>);</span><br><span class="line">  ll cr[<span class="number">4</span>];</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;t;++i) {</span><br><span class="line">    cr[<span class="number">0</span>]=(ll)(P[i].x+<span class="number">0.5</span>)%mod;</span><br><span class="line">    cr[<span class="number">1</span>]=(ll)(P[i].y+<span class="number">0.5</span>)%mod;</span><br><span class="line">    cr[<span class="number">2</span>]=(ll)(Q[i].x+<span class="number">0.5</span>)%mod;</span><br><span class="line">    cr[<span class="number">3</span>]=(ll)(Q[i].y+<span class="number">0.5</span>)%mod;</span><br><span class="line">    c[i]=((cr[<span class="number">0</span>]&lt;&lt;<span class="number">30</span>)+(cr[<span class="number">2</span>]+cr[<span class="number">3</span>]&lt;&lt;<span class="number">15</span>)+cr[<span class="number">1</span>])%mod;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> c;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">30005</span>;</span><br><span class="line">ll n;</span><br><span class="line"><span class="keyword">int</span> fac[N],ifac[N],K,pw1[N&lt;&lt;<span class="number">1</span>],pw2[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getpw</span><span class="params">(<span class="keyword">int</span> x)</span> </span>{ <span class="keyword">return</span> mul(pw1[x%blo],pw2[x/blo]); };</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</span><br><span class="line">  fac[<span class="number">0</span>]=fac[<span class="number">1</span>]=ifac[<span class="number">0</span>]=ifac[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">2</span>;i&lt;=K;++i) {</span><br><span class="line">    fac[i]=mul(fac[i<span class="number">-1</span>],i);</span><br><span class="line">    ifac[i]=mul(ifac[mod-mod/i*i],mod-mod/i);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">2</span>;i&lt;=K;++i) Mul(ifac[i],ifac[i<span class="number">-1</span>]);</span><br><span class="line">  pw1[<span class="number">0</span>]=pw2[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=blo;++i) pw1[i]=add(pw1[i<span class="number">-1</span>],pw1[i<span class="number">-1</span>]);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=blo;++i) pw2[i]=mul(pw2[i<span class="number">-1</span>],pw1[blo]);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span> </span>{ <span class="keyword">return</span> n&lt;m||m&lt;<span class="number">0</span>?<span class="number">0</span>:mul(fac[n],mul(ifac[m],ifac[n-m])); }</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_mul</span><span class="params">(poly a,poly b,<span class="keyword">int</span> len)</span> </span>{</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>,n=(<span class="keyword">int</span>)a.size();i&lt;n;++i) Mul(a[i],getpw((ll)i*len%(mod<span class="number">-1</span>)));</span><br><span class="line">  <span class="keyword">return</span> a*b;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">  <span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">  freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">  <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;K;</span><br><span class="line">  <span class="keyword">if</span>(n&gt;K) <span class="keyword">return</span> <span class="built_in">cout</span>&lt;&lt;<span class="number">0</span>,<span class="number">0</span>;</span><br><span class="line">  init(),init_fft();</span><br><span class="line">  poly res,a(K+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=K;++i) a[i]=ifac[i];</span><br><span class="line">  res=a,--n;</span><br><span class="line">  <span class="keyword">for</span>(ri len=<span class="number">1</span>;n;n&gt;&gt;=<span class="number">1</span>,a=poly_mul(a,a,len),a.resize(K+<span class="number">1</span>),len&lt;&lt;=<span class="number">1</span>) <span class="keyword">if</span>(n&amp;<span class="number">1</span>) {</span><br><span class="line">    res=poly_mul(res,a,len);</span><br><span class="line">    res.resize(K+<span class="number">1</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">int</span> ss=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;=K;++i) Add(ss,mul(res[i],ifac[K-i]));</span><br><span class="line">  <span class="built_in">cout</span>&lt;&lt;mul(ss,fac[K]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="&#x5C04;&#x547D;&#x4E38;&#x6587;&#x7684;&#x7B14;&#x8BB0;"><a class="markdownIt-Anchor" href="#&#x5C04;&#x547D;&#x4E38;&#x6587;&#x7684;&#x7B14;&#x8BB0;"></a> <a href="https://www.luogu.com.cn/problem/P4233" target="_blank" rel="noopener">&#x5C04;&#x547D;&#x4E38;&#x6587;&#x7684;&#x7B14;&#x8BB0;</a></h2>
<details><summary>&#x89E3;&#x9898;&#x601D;&#x8DEF;&#xFF1A;</summary>
<p>&#x8003;&#x8651;&#x7ADE;&#x8D5B;&#x56FE;&#x7684;&#x6027;&#x8D28;&#xFF0C;&#x7531;&#x4E8E;&#x7F29;&#x4E86;&#x56FE;&#x4E4B;&#x540E;&#x4E00;&#x5B9A;&#x662F;&#x94FE;&#x72B6;&#xFF0C;&#x56E0;&#x6B64;&#x8003;&#x8651;&#x679A;&#x4E3E;&#x94FE;&#x5C3E;&#x7684;&#x96C6;&#x5408;&#x5373;&#x53EF;&#x8BA1;&#x7B97;&#x7B54;&#x6848;&#xFF0C;&#x8BBE; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">f_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> &#x8868;&#x793A; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> &#x4E2A;&#x70B9;&#x7B54;&#x6848;&#xFF0C;&#x90A3;&#x4E48;&#x6709; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo>=</mo><msup><mn>2</mn><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mi>i</mi><mn>2</mn></mfrac><mo fence="true">)</mo></mrow></msup><mo>&#x2212;</mo><msubsup><mo>&#x2211;</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>i</mi></msubsup><msub><mi>f</mi><mi>j</mi></msub><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mi>i</mi><mi>j</mi></mfrac><mo fence="true">)</mo></mrow><msup><mn>2</mn><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mi>j</mi><mn>2</mn></mfrac><mo fence="true">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">f_i=2^{\binom{i}2}-\sum\limits_{j=1}^if_j\binom{i}{j}2^{\binom j2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.3910899999999997em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3077599999999998em;"><span style="top:-3.5102599999999997em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen sizing reset-size3 size6 mtight delimcenter" style="top:0.07500000000000001em;"><span class="delimsizing size1 mtight"><span class="mtight">(</span></span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9420857142857142em;"><span style="top:-2.156em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span><span style="top:-2.971em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose sizing reset-size3 size6 mtight delimcenter" style="top:0.07500000000000001em;"><span class="delimsizing size1 mtight"><span class="mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.625446em;vertical-align:-1.113777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5116690000000004em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">&#x2211;</span></span></span><span style="top:-3.950005em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.113777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.905664em;"><span style="top:-2.3550000000000004em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.144em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3077599999999998em;"><span style="top:-3.5102599999999997em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen sizing reset-size3 size6 mtight delimcenter" style="top:0.07500000000000001em;"><span class="delimsizing size1 mtight"><span class="mtight">(</span></span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9420857142857143em;"><span style="top:-2.156em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span><span style="top:-2.971em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose sizing reset-size3 size6 mtight delimcenter" style="top:0.07500000000000001em;"><span class="delimsizing size1 mtight"><span class="mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> &#xFF0C;&#x591A;&#x9879;&#x5F0F;&#x6C42;&#x9006;&#x5373;&#x53EF;</p>
</details>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; poly;</span><br><span class="line"><span class="keyword">namespace</span> modular {</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">998244353</span>;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> a+b&lt;mod?a+b:a+b-mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> a&lt;b?a-b+mod:a-b; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> (ll)a*b%mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=a+b&lt;mod?a+b:a+b-mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=a&lt;b?a-b+mod:a-b; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=(ll)a*b%mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span> </span>{ <span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a)) (p&amp;<span class="number">1</span>)&amp;&amp;(Mul(ret,a),<span class="number">1</span>);<span class="keyword">return</span> ret; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> a)</span> </span>{ <span class="keyword">return</span> ksm(a,mod<span class="number">-2</span>); }</span><br><span class="line">}</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> modular;</span><br><span class="line"><span class="keyword">int</span> lim,tim,invv[<span class="number">23</span>],w[<span class="number">23</span>];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;rev[<span class="number">23</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init_ntt</span><span class="params">()</span> </span>{</span><br><span class="line">  invv[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>,iv=mod+<span class="number">1</span>&gt;&gt;<span class="number">1</span>;i&lt;<span class="number">23</span>;++i) invv[i]=mul(invv[i<span class="number">-1</span>],iv);</span><br><span class="line">  w[<span class="number">22</span>]=ksm(<span class="number">3</span>,(mod<span class="number">-1</span>)&gt;&gt;<span class="number">23</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">21</span>;~i;--i) w[i]=mul(w[i+<span class="number">1</span>],w[i+<span class="number">1</span>]);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> up)</span> </span>{</span><br><span class="line">  lim=<span class="number">1</span>,tim=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(lim&lt;up) lim&lt;&lt;=<span class="number">1</span>,++tim;</span><br><span class="line">  <span class="keyword">if</span>(rev[tim].size()) <span class="keyword">return</span>;</span><br><span class="line">  rev[tim].resize(lim);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;lim;++i) rev[tim][i]=(rev[tim][i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(tim<span class="number">-1</span>));</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ntt</span><span class="params">(poly&amp;a,<span class="keyword">int</span> typ)</span> </span>{</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;lim;++i) <span class="keyword">if</span>(i&lt;rev[tim][i]) swap(a[i],a[rev[tim][i]]);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>,t=<span class="number">0</span>,a0,a1,mt;i&lt;lim;i&lt;&lt;=<span class="number">1</span>,++t) <span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;lim;j+=i&lt;&lt;<span class="number">1</span>) {</span><br><span class="line">    mt=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(ri k=<span class="number">0</span>;k&lt;i;++k,Mul(mt,w[t])) {</span><br><span class="line">      a0=a[j+k],a1=mul(a[j+k+i],mt);</span><br><span class="line">      a[j+k]=add(a0,a1),a[j+k+i]=dec(a0,a1);</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span>(~typ) <span class="keyword">return</span>;</span><br><span class="line">  reverse(++a.begin(),a.end());</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;lim;++i) Mul(a[i],invv[tim]); </span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_inv</span><span class="params">(poly a,<span class="keyword">int</span> K)</span> </span>{</span><br><span class="line">  poly b(1,Inv(a[0])),c;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;K;i&lt;&lt;=<span class="number">1</span>) {</span><br><span class="line">    init(i&lt;&lt;<span class="number">2</span>);</span><br><span class="line">    b.resize(lim),ntt(b,<span class="number">1</span>);</span><br><span class="line">    c=a,c.resize(i&lt;&lt;<span class="number">1</span>),c.resize(lim),ntt(c,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;lim;++j) Mul(b[j],dec(<span class="number">2</span>,mul(b[j],c[j])));</span><br><span class="line">    ntt(b,<span class="number">-1</span>),b.resize(i&lt;&lt;<span class="number">1</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> b.resize(K),b;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100005</span>;</span><br><span class="line"><span class="keyword">int</span> n,fac[N],ifac[N],pw1[<span class="number">1</span>&lt;&lt;<span class="number">15</span>|<span class="number">5</span>],pw2[<span class="number">1</span>&lt;&lt;<span class="number">15</span>|<span class="number">5</span>],md=(<span class="number">1</span>&lt;&lt;<span class="number">15</span>)<span class="number">-1</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getpw</span><span class="params">(<span class="keyword">int</span> x)</span> </span>{ <span class="keyword">return</span>  mul(pw1[x&amp;md],pw2[x&gt;&gt;<span class="number">15</span>]); }</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</span><br><span class="line">  fac[<span class="number">0</span>]=fac[<span class="number">1</span>]=ifac[<span class="number">0</span>]=ifac[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">2</span>;i&lt;=n;++i) {</span><br><span class="line">    fac[i]=mul(fac[i<span class="number">-1</span>],i);</span><br><span class="line">    ifac[i]=mul(ifac[mod-mod/i*i],mod-mod/i);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">2</span>;i&lt;=n;++i) Mul(ifac[i],ifac[i<span class="number">-1</span>]);</span><br><span class="line">  pw1[<span class="number">0</span>]=pw2[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=md+<span class="number">1</span>;++i) pw1[i]=add(pw1[i<span class="number">-1</span>],pw1[i<span class="number">-1</span>]);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=md+<span class="number">1</span>;++i) pw2[i]=mul(pw2[i<span class="number">-1</span>],pw1[md+<span class="number">1</span>]);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">  <span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">  freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">  init_ntt();</span><br><span class="line">  <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">  init();</span><br><span class="line">  <span class="function">poly <span class="title">f</span><span class="params">(n+<span class="number">1</span>)</span></span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;=n;++i) f[i]=mul(ifac[i],getpw((ll)i*(i<span class="number">-1</span>)/<span class="number">2</span>%(mod<span class="number">-1</span>)));</span><br><span class="line">  f=poly_inv(f,n+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;=n;++i) f[i]=mul(dec(!i,f[i]),fac[i]);</span><br><span class="line">  <span class="keyword">if</span>(n&gt;=<span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(n&gt;=<span class="number">2</span>) <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">3</span>;i&lt;=n;++i) <span class="built_in">cout</span>&lt;&lt;mul(mul(fac[i<span class="number">-1</span>],getpw(((ll)i*(i<span class="number">-1</span>)/<span class="number">2</span>-i)%(mod<span class="number">-1</span>))),Inv(f[i]))&lt;&lt;<span class="string">&apos;\n&apos;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="&#x8FB9;&#x53CC;&#x8FDE;&#x901A;&#x56FE;&#x8BA1;&#x6570;"><a class="markdownIt-Anchor" href="#&#x8FB9;&#x53CC;&#x8FDE;&#x901A;&#x56FE;&#x8BA1;&#x6570;"></a> <a href="https://www.luogu.com.cn/problem/P5828" target="_blank" rel="noopener">&#x8FB9;&#x53CC;&#x8FDE;&#x901A;&#x56FE;&#x8BA1;&#x6570;</a></h2>
<details><summary>&#x89E3;&#x9898;&#x601D;&#x8DEF;&#xFF1A;</summary>
&#x4E0D;&#x4F1A;&#x7684;&#x8BF7;&#x81EA;&#x884C;&#x67E5;&#x9605; jcvb &#x7684;&#x56FD;&#x96C6;&#x961F;&#x8BBA;&#x6587;&#x6216;&#x8005;&#x76F4;&#x63A5;&#x627E;&#x535A;&#x4E3B;&#x672C;&#x4EBA;&#x8BE2;&#x95EE;
</details>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; poly;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">namespace</span> modular {</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">998244353</span>;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> a+b&lt;mod?a+b:a+b-mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> a&lt;b?a-b+mod:a-b; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> (ll)a*b%mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=a+b&lt;mod?a+b:a+b-mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=a&lt;b?a-b+mod:a-b; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=(ll)a*b%mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span> </span>{ <span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a)) (p&amp;<span class="number">1</span>)&amp;&amp;(Mul(ret,a),<span class="number">1</span>);<span class="keyword">return</span> ret; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> a)</span> </span>{ <span class="keyword">return</span> ksm(a,mod<span class="number">-2</span>); }</span><br><span class="line">}</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> modular;</span><br><span class="line"><span class="keyword">int</span> lim,tim,invv[<span class="number">23</span>],w[<span class="number">23</span>],inv[<span class="number">1</span>&lt;&lt;<span class="number">18</span>],n;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;rev[<span class="number">23</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init_ntt</span><span class="params">()</span> </span>{</span><br><span class="line">  w[<span class="number">22</span>]=ksm(<span class="number">3</span>,(mod<span class="number">-1</span>)&gt;&gt;<span class="number">23</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">21</span>;~i;--i) w[i]=mul(w[i+<span class="number">1</span>],w[i+<span class="number">1</span>]);</span><br><span class="line">  invv[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>,iv=mod+<span class="number">1</span>&gt;&gt;<span class="number">1</span>;i&lt;<span class="number">23</span>;++i) invv[i]=mul(invv[i<span class="number">-1</span>],iv);</span><br><span class="line">  inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">2</span>,up=<span class="number">1</span>&lt;&lt;<span class="number">18</span>;i&lt;up;++i) inv[i]=mul(inv[mod-mod/i*i],mod-mod/i);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> up)</span> </span>{</span><br><span class="line">  lim=<span class="number">1</span>,tim=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(lim&lt;up) lim&lt;&lt;=<span class="number">1</span>,++tim;</span><br><span class="line">  <span class="keyword">if</span>(rev[tim].size()) <span class="keyword">return</span>;</span><br><span class="line">  rev[tim].resize(lim);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;lim;++i) rev[tim][i]=(rev[tim][i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(tim<span class="number">-1</span>));</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ntt</span><span class="params">(poly&amp;a,<span class="keyword">int</span> typ)</span> </span>{</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;lim;++i) <span class="keyword">if</span>(i&lt;rev[tim][i]) swap(a[i],a[rev[tim][i]]);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>,t=<span class="number">0</span>,a0,a1,mt;i&lt;lim;i&lt;&lt;=<span class="number">1</span>,++t) <span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;lim;j+=i&lt;&lt;<span class="number">1</span>) {</span><br><span class="line">    mt=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(ri k=<span class="number">0</span>;k&lt;i;++k,Mul(mt,w[t])) {</span><br><span class="line">      a0=a[j+k],a1=mul(a[j+k+i],mt);</span><br><span class="line">      a[j+k]=add(a0,a1),a[j+k+i]=dec(a0,a1);</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span>(~typ) <span class="keyword">return</span>;</span><br><span class="line">  reverse(++a.begin(),a.end());</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;lim;++i) Mul(a[i],invv[tim]);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span>*(poly a,poly b) {</span><br><span class="line">  <span class="keyword">int</span> n=(<span class="keyword">int</span>)a.size(),m=(<span class="keyword">int</span>)b.size(),t=n+m<span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">if</span>(t&lt;=<span class="number">128</span>) {</span><br><span class="line">    <span class="function">poly <span class="title">c</span><span class="params">(t)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;n;++i) <span class="keyword">if</span>(a[i]) <span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;m;++j) Add(c[i+j],mul(a[i],b[j]));</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">  }</span><br><span class="line">  init(t);</span><br><span class="line">  a.resize(lim),ntt(a,<span class="number">1</span>);</span><br><span class="line">  b.resize(lim),ntt(b,<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;lim;++i) Mul(a[i],b[i]);</span><br><span class="line">  <span class="keyword">return</span> ntt(a,<span class="number">-1</span>),a.resize(t),a;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span>-(poly a,poly b) {</span><br><span class="line">  <span class="keyword">int</span> n=(<span class="keyword">int</span>)b.size();</span><br><span class="line">  <span class="keyword">if</span>((<span class="keyword">int</span>)a.size()&lt;n) a.resize(n);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;n;++i) Dec(a[i],b[i]);</span><br><span class="line">  <span class="keyword">return</span> a;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_inv</span><span class="params">(poly a,<span class="keyword">int</span> K)</span> </span>{</span><br><span class="line">  poly b(1,Inv(a[0])),c;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;K;i&lt;&lt;=<span class="number">1</span>) {</span><br><span class="line">    init(i&lt;&lt;<span class="number">2</span>);</span><br><span class="line">    b.resize(lim),ntt(b,<span class="number">1</span>);</span><br><span class="line">    c=a,c.resize(i&lt;&lt;<span class="number">1</span>),c.resize(lim),ntt(c,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;lim;++j) Mul(b[j],dec(<span class="number">2</span>,mul(b[j],c[j])));</span><br><span class="line">    ntt(b,<span class="number">-1</span>),b.resize(i&lt;&lt;<span class="number">1</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> b.resize(K),b;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_deriv</span><span class="params">(poly a)</span> </span>{</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>,up=(<span class="keyword">int</span>)a.size();i&lt;up;++i) a[i<span class="number">-1</span>]=mul(a[i],i);</span><br><span class="line">  <span class="keyword">return</span> a.pop_back(),a;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_integ</span><span class="params">(poly a)</span> </span>{</span><br><span class="line">  a.pb(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=(<span class="keyword">int</span>)a.size()<span class="number">-1</span>;i;--i) a[i]=mul(inv[i],a[i<span class="number">-1</span>]);</span><br><span class="line">  <span class="keyword">return</span> a[<span class="number">0</span>]=<span class="number">0</span>,a;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_ln</span><span class="params">(poly a,<span class="keyword">int</span> K)</span> </span>{ <span class="keyword">return</span> a=poly_integ(poly_deriv(a)*poly_inv(a,K)),a.resize(K),a; }</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_exp</span><span class="params">(poly a,<span class="keyword">int</span> K)</span> </span>{</span><br><span class="line">  poly b(1,1),c;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;K;i&lt;&lt;=<span class="number">1</span>) {</span><br><span class="line">    c=a,c.resize(i&lt;&lt;<span class="number">1</span>),Add(c[<span class="number">0</span>],<span class="number">1</span>);</span><br><span class="line">    c=c-poly_ln(b,i&lt;&lt;<span class="number">1</span>),b=b*c,b.resize(i&lt;&lt;<span class="number">1</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> b.resize(K),b;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_ksm</span><span class="params">(poly a,<span class="keyword">int</span> pw,<span class="keyword">int</span> K)</span> </span>{</span><br><span class="line">  a.resize(K);</span><br><span class="line">  a=poly_ln(a,K);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;K;++i) Mul(a[i],pw);</span><br><span class="line">  a=poly_exp(a,K);</span><br><span class="line">  <span class="keyword">return</span> a;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">int</span> fac[<span class="number">100005</span>],ifac[<span class="number">100005</span>],pw1[<span class="number">1</span>&lt;&lt;<span class="number">15</span>|<span class="number">5</span>],pw2[<span class="number">1</span>&lt;&lt;<span class="number">15</span>|<span class="number">5</span>];</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> sqr=(<span class="number">1</span>&lt;&lt;<span class="number">15</span>)<span class="number">-1</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getpw</span><span class="params">(<span class="keyword">int</span> x)</span> </span>{ <span class="keyword">return</span> mul(pw1[x&amp;sqr],pw2[x&gt;&gt;<span class="number">15</span>]); }</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span> </span>{ <span class="keyword">return</span> n&lt;m||m&lt;<span class="number">0</span>?<span class="number">0</span>:mul(fac[n],mul(ifac[m],ifac[n-m])); }</span><br><span class="line">poly F,G,cur1,cur2;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</span><br><span class="line">  fac[<span class="number">0</span>]=fac[<span class="number">1</span>]=ifac[<span class="number">0</span>]=ifac[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">2</span>;i&lt;=<span class="number">100001</span>;++i) {</span><br><span class="line">    fac[i]=mul(fac[i<span class="number">-1</span>],i);</span><br><span class="line">    ifac[i]=mul(ifac[i<span class="number">-1</span>],inv[i]);</span><br><span class="line">  }</span><br><span class="line">  pw1[<span class="number">0</span>]=pw2[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=sqr+<span class="number">1</span>;++i) pw1[i]=add(pw1[i<span class="number">-1</span>],pw1[i<span class="number">-1</span>]);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=sqr+<span class="number">1</span>;++i) pw2[i]=mul(pw2[i<span class="number">-1</span>],pw1[sqr+<span class="number">1</span>]);</span><br><span class="line">  F.resize(<span class="number">100002</span>),G;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;=<span class="number">100001</span>;++i) F[i]=mul(getpw((ll)i*(i<span class="number">-1</span>)/<span class="number">2</span>%(mod<span class="number">-1</span>)),ifac[i]);</span><br><span class="line">  F=poly_ln(F,<span class="number">100002</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;<span class="number">100002</span>;++i) Mul(F[i],i);</span><br><span class="line">  G=F,F=poly_deriv(F);</span><br><span class="line">  G=poly_inv(poly_exp(G,<span class="number">100002</span>),<span class="number">100002</span>);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">  <span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">  freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">  init_ntt();</span><br><span class="line">  init();</span><br><span class="line">  <span class="keyword">for</span>(ri tt=<span class="number">5</span>;tt;--tt) {</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">    cur1=F,cur1.resize(n+<span class="number">1</span>);</span><br><span class="line">    cur2=poly_ksm(G,n,n+<span class="number">1</span>);</span><br><span class="line">    cur1=cur1*cur2;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;mul(mul(fac[n<span class="number">-1</span>],inv[n]),cur1[n<span class="number">-1</span>])&lt;&lt;<span class="string">&apos;\n&apos;</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="&#x70B9;&#x53CC;&#x8FDE;&#x901A;&#x56FE;&#x8BA1;&#x6570;"><a class="markdownIt-Anchor" href="#&#x70B9;&#x53CC;&#x8FDE;&#x901A;&#x56FE;&#x8BA1;&#x6570;"></a> <a href="https://www.luogu.com.cn/problem/P5827" target="_blank" rel="noopener">&#x70B9;&#x53CC;&#x8FDE;&#x901A;&#x56FE;&#x8BA1;&#x6570;</a></h2>
<details><summary>&#x89E3;&#x9898;&#x601D;&#x8DEF;&#xFF1A;</summary>
&#x540C;&#x4E0A;&#x9898;
</details>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; poly;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">namespace</span> modular {</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">998244353</span>;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> a+b&lt;mod?a+b:a+b-mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> a&lt;b?a-b+mod:a-b; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> (ll)a*b%mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=a+b&lt;mod?a+b:a+b-mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=a&lt;b?a-b+mod:a-b; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=(ll)a*b%mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span> </span>{ <span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a)) (p&amp;<span class="number">1</span>)&amp;&amp;(Mul(ret,a),<span class="number">1</span>);<span class="keyword">return</span> ret; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> a)</span> </span>{ <span class="keyword">return</span> ksm(a,mod<span class="number">-2</span>); }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">fix</span><span class="params">(<span class="keyword">int</span> a)</span> </span>{ <span class="keyword">return</span> (a%mod+mod)%mod; }</span><br><span class="line">}</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> modular;</span><br><span class="line"><span class="keyword">int</span> invv[<span class="number">23</span>],w[<span class="number">23</span>],lim,tim,inv[<span class="number">1</span>&lt;&lt;<span class="number">20</span>];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;rev[<span class="number">23</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init_ntt</span><span class="params">()</span> </span>{</span><br><span class="line">  invv[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>,iv=mod+<span class="number">1</span>&gt;&gt;<span class="number">1</span>;i&lt;<span class="number">23</span>;++i) invv[i]=mul(invv[i<span class="number">-1</span>],iv);</span><br><span class="line">  w[<span class="number">22</span>]=ksm(<span class="number">3</span>,(mod<span class="number">-1</span>)&gt;&gt;<span class="number">23</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">21</span>;~i;--i) w[i]=mul(w[i+<span class="number">1</span>],w[i+<span class="number">1</span>]);</span><br><span class="line">  inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">2</span>,up=<span class="number">1</span>&lt;&lt;<span class="number">20</span>;i&lt;up;++i) inv[i]=mul(inv[mod-mod/i*i],mod-mod/i);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> up)</span> </span>{</span><br><span class="line">  lim=<span class="number">1</span>,tim=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(lim&lt;up) lim&lt;&lt;=<span class="number">1</span>,++tim;</span><br><span class="line">  <span class="keyword">if</span>(rev[tim].size()) <span class="keyword">return</span>;</span><br><span class="line">  rev[tim].resize(lim);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;lim;++i) rev[tim][i]=(rev[tim][i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(tim<span class="number">-1</span>));</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ntt</span><span class="params">(poly&amp;a,<span class="keyword">int</span> typ)</span> </span>{</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;lim;++i) <span class="keyword">if</span>(i&lt;rev[tim][i]) swap(a[i],a[rev[tim][i]]);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>,t=<span class="number">0</span>,a0,a1,mt;i&lt;lim;i&lt;&lt;=<span class="number">1</span>,++t) <span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;lim;j+=i&lt;&lt;<span class="number">1</span>) {</span><br><span class="line">    mt=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(ri k=<span class="number">0</span>;k&lt;i;++k,Mul(mt,w[t])) {</span><br><span class="line">     a0=a[j+k],a1=mul(a[j+k+i],mt);</span><br><span class="line">     a[j+k]=add(a0,a1),a[j+k+i]=dec(a0,a1);</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span>(~typ) <span class="keyword">return</span>;</span><br><span class="line">  reverse(++a.begin(),a.end());</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;lim;++i) Mul(a[i],invv[tim]);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span>*(poly a,poly b) {</span><br><span class="line">  <span class="keyword">int</span> n=(<span class="keyword">int</span>)a.size(),m=(<span class="keyword">int</span>)b.size(),t=n+m<span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">if</span>(t&lt;=<span class="number">128</span>) {</span><br><span class="line">    <span class="function">poly <span class="title">c</span><span class="params">(t)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;n;++i) <span class="keyword">if</span>(a[i]) <span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;m;++j) Add(c[i+j],mul(a[i],b[j]));</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">  }</span><br><span class="line">  init(t);</span><br><span class="line">  a.resize(lim),ntt(a,<span class="number">1</span>);</span><br><span class="line">  b.resize(lim),ntt(b,<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;lim;++i) Mul(a[i],b[i]);</span><br><span class="line">  <span class="keyword">return</span> ntt(a,<span class="number">-1</span>),a.resize(t),a;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span>-(poly a,poly b) {</span><br><span class="line">  <span class="keyword">int</span> n=(<span class="keyword">int</span>)b.size();</span><br><span class="line">  <span class="keyword">if</span>((<span class="keyword">int</span>)a.size()&lt;n) a.resize(n);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;n;++i) Dec(a[i],b[i]);</span><br><span class="line">  <span class="keyword">return</span> a;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_inv</span><span class="params">(poly a,<span class="keyword">int</span> K)</span> </span>{</span><br><span class="line">  poly b(1,Inv(a[0])),c;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;K;i&lt;&lt;=<span class="number">1</span>) {</span><br><span class="line">    init(i&lt;&lt;<span class="number">2</span>);</span><br><span class="line">    b.resize(lim),ntt(b,<span class="number">1</span>);</span><br><span class="line">    c=a,c.resize(i&lt;&lt;<span class="number">1</span>),c.resize(lim),ntt(c,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;lim;++j) Mul(b[j],dec(<span class="number">2</span>,mul(b[j],c[j])));</span><br><span class="line">    ntt(b,<span class="number">-1</span>),b.resize(i&lt;&lt;<span class="number">1</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> b.resize(K),b;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_deriv</span><span class="params">(poly a)</span> </span>{</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>,up=(<span class="keyword">int</span>)a.size();i&lt;up;++i) a[i<span class="number">-1</span>]=mul(a[i],i);</span><br><span class="line">  <span class="keyword">return</span> a.pop_back(),a;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_integ</span><span class="params">(poly a)</span> </span>{</span><br><span class="line">  a.pb(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=(<span class="keyword">int</span>)a.size()<span class="number">-1</span>;i;--i) a[i]=mul(inv[i],a[i<span class="number">-1</span>]);</span><br><span class="line">  <span class="keyword">return</span> a[<span class="number">0</span>]=<span class="number">0</span>,a;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_ln</span><span class="params">(poly a,<span class="keyword">int</span> K)</span> </span>{ <span class="keyword">return</span> a=poly_integ(poly_deriv(a)*poly_inv(a,K)),a.resize(K),a; }</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_exp</span><span class="params">(poly a,<span class="keyword">int</span> K)</span> </span>{</span><br><span class="line">  poly b(1,1),c;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;K;i&lt;&lt;=<span class="number">1</span>) {</span><br><span class="line">    c=a,c.resize(i&lt;&lt;<span class="number">1</span>),Add(c[<span class="number">0</span>],<span class="number">1</span>);</span><br><span class="line">    b=b*(c-poly_ln(b,i&lt;&lt;<span class="number">1</span>)),b.resize(i&lt;&lt;<span class="number">1</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> b.resize(K),b;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>,blo=(<span class="number">1</span>&lt;&lt;<span class="number">15</span>)<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> n,fac[N],ifac[N],pw1[N],pw2[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getpw</span><span class="params">(<span class="keyword">int</span> x)</span> </span>{ <span class="keyword">return</span> mul(pw1[x&amp;blo],pw2[x&gt;&gt;<span class="number">15</span>]); }</span><br><span class="line">poly cur1,cur2,F,G;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</span><br><span class="line">  fac[<span class="number">0</span>]=fac[<span class="number">1</span>]=ifac[<span class="number">0</span>]=ifac[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">2</span>;i&lt;=<span class="number">100001</span>;++i) {</span><br><span class="line">    fac[i]=mul(fac[i<span class="number">-1</span>],i);</span><br><span class="line">    ifac[i]=mul(ifac[i<span class="number">-1</span>],inv[i]);</span><br><span class="line">  }</span><br><span class="line">  pw1[<span class="number">0</span>]=pw2[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=blo+<span class="number">1</span>;++i) pw1[i]=add(pw1[i<span class="number">-1</span>],pw1[i<span class="number">-1</span>]);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=blo+<span class="number">1</span>;++i) pw2[i]=mul(pw2[i<span class="number">-1</span>],pw1[blo+<span class="number">1</span>]);</span><br><span class="line">  F.resize(<span class="number">100002</span>),G.resize(<span class="number">100001</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;=<span class="number">100001</span>;++i) F[i]=mul(ifac[i],getpw((ll)i*(i<span class="number">-1</span>)/<span class="number">2</span>%(mod<span class="number">-1</span>)));</span><br><span class="line">  F=poly_ln(F,<span class="number">100002</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;=<span class="number">100001</span>;++i) {</span><br><span class="line">    Mul(F[i],i);</span><br><span class="line">    <span class="keyword">if</span>(i) G[i<span class="number">-1</span>]=F[i];</span><br><span class="line">  }</span><br><span class="line">  G=poly_deriv(F=poly_ln(G,<span class="number">100001</span>));</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">  <span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">  freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">  init_ntt();</span><br><span class="line">  init();</span><br><span class="line">  <span class="keyword">for</span>(ri tt=<span class="number">5</span>;tt;--tt) {</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">1</span>) { <span class="built_in">puts</span>(<span class="string">&quot;1&quot;</span>);<span class="keyword">continue</span>; }</span><br><span class="line">    cur1=G,cur1.resize(n);</span><br><span class="line">    cur2=F,cur2.resize(n);</span><br><span class="line">    <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;n;++i) Mul(cur2[i],mod-(n<span class="number">-1</span>));</span><br><span class="line">    cur1=cur1*poly_exp(cur2,n);</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;mul(fac[n<span class="number">-1</span>],mul(inv[n<span class="number">-1</span>],cur1[n<span class="number">-2</span>]))&lt;&lt;<span class="string">&apos;\n&apos;</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="calc&#x52A0;&#x5F3A;&#x7248;"><a class="markdownIt-Anchor" href="#calc&#x52A0;&#x5F3A;&#x7248;"></a> <a href="https://www.luogu.com.cn/problem/P5850" target="_blank" rel="noopener">calc&#x52A0;&#x5F3A;&#x7248;</a></h2>
<details><summary>&#x89E3;&#x9898;&#x601D;&#x8DEF;&#xFF1A;</summary>
<p>&#x53D1;&#x73B0;&#x7B54;&#x6848;&#x5C31;&#x662F; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><msup><mi>x</mi><mi>n</mi></msup><mo stretchy="false">]</mo><msubsup><mo>&#x220F;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>A</mi></msubsup><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>i</mi><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[x^n]\prod\limits_{i=1}^A(1+ix)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.506005em;vertical-align:-0.9776689999999999em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5283360000000004em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">&#x220F;</span></span></span><span style="top:-3.950005em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></p>
<p>&#x53D6;&#x4E2A;&#x5BF9;&#x6570;&#xFF1A;</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">[</mo><msup><mi>x</mi><mi>n</mi></msup><mo stretchy="false">]</mo><msup><mi>e</mi><mrow><munderover><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>A</mi></munderover><mi>ln</mi><mo>&#x2061;</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>i</mi><mi>x</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">[</mo><msup><mi>x</mi><mi>n</mi></msup><mo stretchy="false">]</mo><msup><mi>e</mi><mrow><munderover><mo>&#x2211;</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>A</mi></munderover><munderover><mo>&#x2211;</mo><mrow><mi>i</mi><mo>&gt;</mo><mn>0</mn></mrow><mrow><mo>+</mo><mi mathvariant="normal">&#x221E;</mi></mrow></munderover><mfrac><mrow><mo stretchy="false">(</mo><mi>t</mi><mi>x</mi><msup><mo stretchy="false">)</mo><mi>i</mi></msup></mrow><mi>i</mi></mfrac><mo stretchy="false">(</mo><mo>&#x2212;</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">[</mo><msup><mi>x</mi><mi>n</mi></msup><mo stretchy="false">]</mo><msup><mi>e</mi><mrow><munderover><mo>&#x2211;</mo><mrow><mi>i</mi><mo>&gt;</mo><mn>0</mn></mrow><mrow><mo>+</mo><mi mathvariant="normal">&#x221E;</mi></mrow></munderover><msup><mi>x</mi><mi>i</mi></msup><mo stretchy="false">(</mo><mo>&#x2212;</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><munderover><mo>&#x2211;</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>A</mi></munderover><msup><mi>t</mi><mi>i</mi></msup></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">[</mo><msup><mi>x</mi><mi>n</mi></msup><mo stretchy="false">]</mo><msup><mi>e</mi><mrow><munderover><mo>&#x2211;</mo><mrow><mi>i</mi><mo>&gt;</mo><mn>0</mn></mrow><mi>n</mi></munderover><msup><mi>x</mi><mi>i</mi></msup><mo stretchy="false">(</mo><mo>&#x2212;</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><munderover><mo>&#x2211;</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>A</mi></munderover><msup><mi>t</mi><mi>i</mi></msup></mrow></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
=&amp;[x^n]e^{\sum\limits_{i=1}^A\ln(1+ix)}\\
=&amp;[x^n]e^{\sum\limits_{t=1}^A\sum\limits_{i&gt;0}^{+\infty}\frac{(tx)^i}{i}(-1)^{i+1}}\\
=&amp;[x^n]e^{\sum\limits_{i&gt;0}^{+\infty}x^i(-1)^{i+1}\sum\limits_{t=1}^At^i}\\
=&amp;[x^n]e^{\sum\limits_{i&gt;0}^{n}x^i(-1)^{i+1}\sum\limits_{t=1}^At^i}\\
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:10.440978000000001em;vertical-align:-4.970489000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.470489000000001em;"><span style="top:-7.490039em;"><span class="pstrut" style="height:3.955132em;"></span><span class="mord"><span class="mrel">=</span></span></span><span style="top:-4.874907em;"><span class="pstrut" style="height:3.955132em;"></span><span class="mord"><span class="mrel">=</span></span></span><span style="top:-2.2597750000000003em;"><span class="pstrut" style="height:3.955132em;"></span><span class="mord"><span class="mrel">=</span></span></span><span style="top:0.3553570000000006em;"><span class="pstrut" style="height:3.955132em;"></span><span class="mord"><span class="mrel">=</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:4.970489000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.470489000000001em;"><span style="top:-7.490039em;"><span class="pstrut" style="height:3.955132em;"></span><span class="mord"><span class="mord"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.935582em;"><span style="top:-3.9355819999999997em;margin-right:0.05em;"><span class="pstrut" style="height:3.1067685em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop op-limits mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.581097857142857em;"><span style="top:-1.8629092857142857em;margin-left:0em;"><span class="pstrut" style="height:2.75em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.7500050000000003em;"><span class="pstrut" style="height:2.75em;"></span><span><span class="mop op-symbol small-op mtight">&#x2211;</span></span></span><span style="top:-3.700005em;margin-left:0em;"><span class="pstrut" style="height:2.75em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.0300907142857143em;"><span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mop mtight">ln</span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">x</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span style="top:-4.874907em;"><span class="pstrut" style="height:3.955132em;"></span><span class="mord"><span class="mord"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.955132em;"><span style="top:-3.9551320000000003em;margin-right:0.05em;"><span class="pstrut" style="height:3.1067685000000003em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop op-limits mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5810978571428573em;"><span style="top:-1.8736807142857144em;margin-left:0em;"><span class="pstrut" style="height:2.75em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.7500050000000003em;"><span class="pstrut" style="height:2.75em;"></span><span><span class="mop op-symbol small-op mtight">&#x2211;</span></span></span><span style="top:-3.700005em;margin-left:0em;"><span class="pstrut" style="height:2.75em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.0193192857142857em;"><span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mop op-limits mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.509669285714286em;"><span style="top:-1.862909285714286em;margin-left:0em;"><span class="pstrut" style="height:2.75em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">&gt;</span><span class="mord mtight">0</span></span></span></span><span style="top:-2.7500050000000003em;"><span class="pstrut" style="height:2.75em;"></span><span><span class="mop op-symbol small-op mtight">&#x2211;</span></span></span><span style="top:-3.7000050000000004em;margin-left:0em;"><span class="pstrut" style="height:2.75em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">+</span><span class="mord mtight">&#x221E;</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.0580192857142856em;"><span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2617285714285715em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.5020714285714285em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">x</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.06352em;"><span style="top:-3.06352em;margin-right:0.1em;"><span class="pstrut" style="height:2.65952em;"></span><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mopen mtight">(</span><span class="mord mtight">&#x2212;</span><span class="mord mtight">1</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9020857142857143em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.2597750000000003em;"><span class="pstrut" style="height:3.955132em;"></span><span class="mord"><span class="mord"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.955132em;"><span style="top:-3.9551320000000003em;margin-right:0.05em;"><span class="pstrut" style="height:3.1067685000000003em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop op-limits mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.509669285714286em;"><span style="top:-1.862909285714286em;margin-left:0em;"><span class="pstrut" style="height:2.75em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">&gt;</span><span class="mord mtight">0</span></span></span></span><span style="top:-2.7500050000000003em;"><span class="pstrut" style="height:2.75em;"></span><span><span class="mop op-symbol small-op mtight">&#x2211;</span></span></span><span style="top:-3.7000050000000004em;margin-left:0em;"><span class="pstrut" style="height:2.75em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">+</span><span class="mord mtight">&#x221E;</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.0580192857142856em;"><span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9020857142857143em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight">&#x2212;</span><span class="mord mtight">1</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9020857142857143em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mop op-limits mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5810978571428573em;"><span style="top:-1.8736807142857144em;margin-left:0em;"><span class="pstrut" style="height:2.75em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.7500050000000003em;"><span class="pstrut" style="height:2.75em;"></span><span><span class="mop op-symbol small-op mtight">&#x2211;</span></span></span><span style="top:-3.700005em;margin-left:0em;"><span class="pstrut" style="height:2.75em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.0193192857142857em;"><span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9020857142857143em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:0.3553570000000006em;"><span class="pstrut" style="height:3.955132em;"></span><span class="mord"><span class="mord"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.955132em;"><span style="top:-3.9551320000000003em;margin-right:0.05em;"><span class="pstrut" style="height:3.1067685000000003em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop op-limits mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4005478571428573em;"><span style="top:-1.862909285714286em;margin-left:0em;"><span class="pstrut" style="height:2.75em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">&gt;</span><span class="mord mtight">0</span></span></span></span><span style="top:-2.7500050000000003em;"><span class="pstrut" style="height:2.75em;"></span><span><span class="mop op-symbol small-op mtight">&#x2211;</span></span></span><span style="top:-3.700005em;margin-left:0em;"><span class="pstrut" style="height:2.75em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.0580192857142856em;"><span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9020857142857143em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight">&#x2212;</span><span class="mord mtight">1</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9020857142857143em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mop op-limits mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5810978571428573em;"><span style="top:-1.8736807142857144em;margin-left:0em;"><span class="pstrut" style="height:2.75em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.7500050000000003em;"><span class="pstrut" style="height:2.75em;"></span><span><span class="mop op-symbol small-op mtight">&#x2211;</span></span></span><span style="top:-3.700005em;margin-left:0em;"><span class="pstrut" style="height:2.75em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.0193192857142857em;"><span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9020857142857143em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:4.970489000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>&#x53D1;&#x73B0;&#x540E;&#x9762;&#x4E00;&#x5768;&#x53EF;&#x4EE5;&#x6784;&#x9020; EGF &#x6C42;&#x548C;&#xFF1A;</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><munderover><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>A</mi></munderover><msup><mi>i</mi><mi>t</mi></msup><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">[</mo><msup><mi>x</mi><mi>t</mi></msup><mo stretchy="false">]</mo><mo stretchy="false">(</mo><munderover><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>A</mi></munderover><munderover><mo>&#x2211;</mo><mrow><mi>j</mi><mo>&gt;</mo><mn>0</mn></mrow><mrow><mo>+</mo><mi mathvariant="normal">&#x221E;</mi></mrow></munderover><mfrac><mrow><msup><mi>i</mi><mi>j</mi></msup><msup><mi>x</mi><mi>i</mi></msup></mrow><mrow><mi>i</mi><mo stretchy="false">!</mo></mrow></mfrac><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">[</mo><msup><mi>x</mi><mi>t</mi></msup><mo stretchy="false">]</mo><mo stretchy="false">(</mo><munderover><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>A</mi></munderover><msup><mi>e</mi><mrow><mi>i</mi><mi>x</mi></mrow></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">[</mo><msup><mi>x</mi><mi>t</mi></msup><mo stretchy="false">]</mo><mfrac><mrow><msup><mi>e</mi><mrow><mo stretchy="false">(</mo><mi>A</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mi>x</mi></mrow></msup><mo>&#x2212;</mo><mn>1</mn></mrow><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>&#x2212;</mo><mn>1</mn></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\sum\limits_{i=1}^Ai^t=&amp;[x^t](\sum\limits_{i=1}^A\sum\limits_{j&gt;0}^{+\infty}\frac{i^jx^i}{i!})\\
=&amp;[x^t](\sum\limits_{i=1}^Ae^{ix})\\
=&amp;[x^t]\frac{e^{(A+1)x}-1}{e^x-1}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.582448000000001em;vertical-align:-4.541224000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.041224000000001em;"><span style="top:-7.0412240000000015em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-3.499111em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord"><span class="mrel">=</span></span></span><span style="top:-0.3564419999999997em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord"><span class="mrel">=</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:4.541224000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.041224000000001em;"><span style="top:-7.0412240000000015em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord"><span class="mord"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7583360000000008em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">&gt;</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span><span class="mord mtight">&#x221E;</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5016639999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">i</span><span class="mclose">!</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-3.499111em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord"><span class="mord"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-0.3564419999999997em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord"><span class="mord"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.565em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.590392em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">A</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:4.541224000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>&#x591A;&#x9879;&#x5F0F;&#x6C42;&#x9006;+&#x591A;&#x9879;&#x5F0F; exp &#x5373;&#x53EF;</p>
</details>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; poly;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">namespace</span> modular {</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">998244353</span>;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> a+b&lt;mod?a+b:a+b-mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> a&lt;b?a-b+mod:a-b; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> (ll)a*b%mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=a+b&lt;mod?a+b:a+b-mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=a&lt;b?a-b+mod:a-b; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=(ll)a*b%mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span> </span>{ <span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a)) (p&amp;<span class="number">1</span>)&amp;&amp;(Mul(ret,a),<span class="number">1</span>);<span class="keyword">return</span> ret; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> a)</span> </span>{ <span class="keyword">return</span> ksm(a,mod<span class="number">-2</span>); }</span><br><span class="line">}</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> modular;</span><br><span class="line"><span class="keyword">int</span> lim,tim,invv[<span class="number">23</span>],w[<span class="number">23</span>],inv[<span class="number">1</span>&lt;&lt;<span class="number">20</span>];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;rev[<span class="number">23</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init_ntt</span><span class="params">()</span> </span>{</span><br><span class="line">  w[<span class="number">22</span>]=ksm(<span class="number">3</span>,(mod<span class="number">-1</span>)&gt;&gt;<span class="number">23</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">21</span>;~i;--i) w[i]=mul(w[i+<span class="number">1</span>],w[i+<span class="number">1</span>]);</span><br><span class="line">  invv[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri iv=mod+<span class="number">1</span>&gt;&gt;<span class="number">1</span>,i=<span class="number">1</span>;i&lt;<span class="number">23</span>;++i) invv[i]=mul(invv[i<span class="number">-1</span>],iv);</span><br><span class="line">  inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">2</span>,up=<span class="number">1</span>&lt;&lt;<span class="number">20</span>;i&lt;up;++i) inv[i]=mul(inv[mod-mod/i*i],mod-mod/i);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> up)</span> </span>{</span><br><span class="line">  lim=<span class="number">1</span>,tim=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(lim&lt;up) lim&lt;&lt;=<span class="number">1</span>,++tim;</span><br><span class="line">  <span class="keyword">if</span>(rev[tim].size()) <span class="keyword">return</span>;</span><br><span class="line">  rev[tim].resize(lim);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;lim;++i) rev[tim][i]=(rev[tim][i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(tim<span class="number">-1</span>));</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ntt</span><span class="params">(poly&amp;a,<span class="keyword">int</span> typ)</span> </span>{</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;lim;++i) <span class="keyword">if</span>(i&lt;rev[tim][i]) swap(a[i],a[rev[tim][i]]);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>,t=<span class="number">0</span>,a0,a1,mt;i&lt;lim;i&lt;&lt;=<span class="number">1</span>,++t) <span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;lim;j+=i&lt;&lt;<span class="number">1</span>) {</span><br><span class="line">    mt=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(ri k=<span class="number">0</span>;k&lt;i;++k,Mul(mt,w[t])) {</span><br><span class="line">      a0=a[j+k],a1=mul(a[j+k+i],mt);</span><br><span class="line">      a[j+k]=add(a0,a1),a[j+k+i]=dec(a0,a1);</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span>(~typ) <span class="keyword">return</span>;</span><br><span class="line">  reverse(++a.begin(),a.end());</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;lim;++i) Mul(a[i],invv[tim]);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span>*(poly a,poly b) {</span><br><span class="line">  <span class="keyword">int</span> n=(<span class="keyword">int</span>)a.size(),m=(<span class="keyword">int</span>)b.size(),t=n+m<span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">if</span>(t&lt;=<span class="number">128</span>) {</span><br><span class="line">    <span class="function">poly <span class="title">c</span><span class="params">(t)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;n;++i) <span class="keyword">if</span>(a[i]) <span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;m;++j) Add(c[i+j],mul(a[i],b[j]));</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">  }</span><br><span class="line">  init(t);</span><br><span class="line">  a.resize(lim),ntt(a,<span class="number">1</span>);</span><br><span class="line">  b.resize(lim),ntt(b,<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;lim;++i) Mul(a[i],b[i]);</span><br><span class="line">  <span class="keyword">return</span> ntt(a,<span class="number">-1</span>),a.resize(t),a;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span>-(poly a,poly b) {</span><br><span class="line">  <span class="keyword">int</span> n=(<span class="keyword">int</span>)b.size();</span><br><span class="line">  <span class="keyword">if</span>((<span class="keyword">int</span>)a.size()&lt;n) a.resize(n);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;n;++i) Dec(a[i],b[i]);</span><br><span class="line">  <span class="keyword">return</span> a;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_inv</span><span class="params">(poly a,<span class="keyword">int</span> K)</span> </span>{</span><br><span class="line">  poly b(1,Inv(a[0])),c;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;K;i&lt;&lt;=<span class="number">1</span>) {</span><br><span class="line">    init(i*<span class="number">3</span>);</span><br><span class="line">    b.resize(lim),ntt(b,<span class="number">1</span>);</span><br><span class="line">    c=a,c.resize(i&lt;&lt;<span class="number">1</span>),c.resize(lim),ntt(c,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;lim;++j) Mul(b[j],dec(<span class="number">2</span>,mul(b[j],c[j])));</span><br><span class="line">    ntt(b,<span class="number">-1</span>),b.resize(i&lt;&lt;<span class="number">1</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> b.resize(K),b;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_deriv</span><span class="params">(poly a)</span> </span>{</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>,up=(<span class="keyword">int</span>)a.size();i&lt;up;++i) a[i<span class="number">-1</span>]=mul(a[i],i);</span><br><span class="line">  <span class="keyword">return</span> a.pop_back(),a;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_integ</span><span class="params">(poly a)</span> </span>{</span><br><span class="line">  a.pb(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=(<span class="keyword">int</span>)a.size()<span class="number">-1</span>;i;--i) a[i]=mul(inv[i],a[i<span class="number">-1</span>]);</span><br><span class="line">  <span class="keyword">return</span> a[<span class="number">0</span>]=<span class="number">0</span>,a;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_ln</span><span class="params">(poly a,<span class="keyword">int</span> K)</span> </span>{ <span class="keyword">return</span> a=poly_integ(poly_deriv(a)*poly_inv(a,K)),a.resize(K),a; }</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_exp</span><span class="params">(poly a,<span class="keyword">int</span> K)</span> </span>{</span><br><span class="line">  poly b(1,1),c;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;K;i&lt;&lt;=<span class="number">1</span>) {</span><br><span class="line">    c=a,c.resize(i&lt;&lt;<span class="number">1</span>),Add(c[<span class="number">0</span>],<span class="number">1</span>);</span><br><span class="line">    b=b*(c-poly_ln(b,i&lt;&lt;<span class="number">1</span>)),b.resize(i&lt;&lt;<span class="number">1</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> b.resize(K),b;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">5e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> K,n,fac[N],ifac[N];</span><br><span class="line">poly F,G;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</span><br><span class="line">  fac[<span class="number">0</span>]=fac[<span class="number">1</span>]=ifac[<span class="number">0</span>]=ifac[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">2</span>;i&lt;=n+<span class="number">1</span>;++i) {</span><br><span class="line">    fac[i]=mul(fac[i<span class="number">-1</span>],i);</span><br><span class="line">    ifac[i]=mul(ifac[i<span class="number">-1</span>],inv[i]);</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">  <span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">  freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">  init_ntt();</span><br><span class="line">  <span class="built_in">cin</span>&gt;&gt;K&gt;&gt;n;</span><br><span class="line">  init();</span><br><span class="line">  F.resize(n+<span class="number">1</span>),G.resize(n+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>,rs=K+<span class="number">1</span>,mt=rs;i&lt;=n;++i,Mul(rs,mt)) F[i]=ifac[i+<span class="number">1</span>],G[i]=mul(F[i],rs);</span><br><span class="line">  G=G*poly_inv(F,n+<span class="number">1</span>);</span><br><span class="line">  F[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri t,i=<span class="number">1</span>;i&lt;=n;++i) {</span><br><span class="line">    t=mul(fac[i<span class="number">-1</span>],G[i]);</span><br><span class="line">    F[i]=i&amp;<span class="number">1</span>?t:(t?mod-t:<span class="number">0</span>);</span><br><span class="line">  }</span><br><span class="line">  F=poly_exp(F,n+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">cout</span>&lt;&lt;mul(fac[i],F[i])&lt;&lt;<span class="string">&apos;\n&apos;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="&#x96C6;&#x5408;&#x5212;&#x5206;&#x8BA1;&#x6570;"><a class="markdownIt-Anchor" href="#&#x96C6;&#x5408;&#x5212;&#x5206;&#x8BA1;&#x6570;"></a> <a href="https://www.luogu.com.cn/problem/P5748" target="_blank" rel="noopener">&#x96C6;&#x5408;&#x5212;&#x5206;&#x8BA1;&#x6570;</a></h2>
<details><summary>&#x89E3;&#x9898;&#x601D;&#x8DEF;&#xFF1A;</summary>
<p>&#x8003;&#x8651; DP &#x8D1D;&#x5C14;&#x6570;&#xFF1A;</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>f</mi><mi>n</mi></msub><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munderover><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>&#x2212;</mo><mn>1</mn></mrow></munderover><msub><mi>f</mi><mi>i</mi></msub><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mrow><mi>n</mi><mo>&#x2212;</mo><mn>1</mn></mrow><mi>i</mi></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">&#x4EE4;</mi><mi>F</mi><mi mathvariant="normal">&#x4E3A;</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>f</mi><mi mathvariant="normal">&#x7684;</mi><mi mathvariant="normal">&#x751F;</mi><mi mathvariant="normal">&#x6210;</mi><mi mathvariant="normal">&#x51FD;</mi><mi mathvariant="normal">&#x6570;</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>x</mi><msup><mi>F</mi><mo mathvariant="normal">&#x2032;</mo></msup><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>F</mi><mo>&#x22C5;</mo><mo stretchy="false">(</mo><mi>x</mi><msup><mi>e</mi><mi>x</mi></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>F</mi><mo mathvariant="normal">&#x2032;</mo></msup><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>F</mi><msup><mi>e</mi><mi>x</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>F</mi><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>e</mi><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>+</mo><mi>C</mi></mrow></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
f_n=&amp;\sum\limits_{i=0}^{n-1}f_i\binom{n-1}{i}\\
&#x4EE4; F &#x4E3A;&amp; f &#x7684;&#x751F;&#x6210;&#x51FD;&#x6570;\\
xF&apos;=&amp;F\cdot(xe^x)\\
F&apos;=&amp;Fe^x\\
F=&amp;e^{e^x+C}\\
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.468761999999998em;vertical-align:-4.484380999999999em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.984381em;"><span style="top:-6.984381em;"><span class="pstrut" style="height:3.8011130000000004em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-4.566712000000001em;"><span class="pstrut" style="height:3.8011130000000004em;"></span><span class="mord"><span class="mord cjk_fallback">&#x4EE4;</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord cjk_fallback">&#x4E3A;</span></span></span><span style="top:-3.0667120000000008em;"><span class="pstrut" style="height:3.8011130000000004em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">&#x2032;</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-1.5667120000000008em;"><span class="pstrut" style="height:3.8011130000000004em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">&#x2032;</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:0.023267999999998512em;"><span class="pstrut" style="height:3.8011130000000004em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:4.484380999999999em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.984381em;"><span style="top:-6.984381em;"><span class="pstrut" style="height:3.8011130000000004em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000004em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">i</span></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:-4.566712000000001em;"><span class="pstrut" style="height:3.8011130000000004em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord cjk_fallback">&#x7684;</span><span class="mord cjk_fallback">&#x751F;</span><span class="mord cjk_fallback">&#x6210;</span><span class="mord cjk_fallback">&#x51FD;</span><span class="mord cjk_fallback">&#x6570;</span></span></span><span style="top:-3.0667120000000008em;"><span class="pstrut" style="height:3.8011130000000004em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-1.5667120000000008em;"><span class="pstrut" style="height:3.8011130000000004em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span><span style="top:0.023267999999998512em;"><span class="pstrut" style="height:3.8011130000000004em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.92998em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7385428571428572em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.07153em;">C</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:4.484380999999999em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>&#x5E26;&#x5165; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">f_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> &#x53EF;&#x77E5; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>=</mo><mo>&#x2212;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">C=-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">&#x2212;</span><span class="mord">1</span></span></span></span><br>
&#x591A;&#x9879;&#x5F0F; exp &#x5373;&#x53EF;</p>
</details>
<details><summary>CODE</summary>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ri register int</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; poly;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> rlen=<span class="number">1</span>&lt;&lt;<span class="number">18</span>|<span class="number">1</span>;</span><br><span class="line"><span class="keyword">char</span> buf[rlen],*ib=buf,*ob=buf;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc() (((ib==ob)&amp;&amp;(ob=(ib=buf)+fread(buf,1,rlen,stdin)),ib==ob)?-1:*ib++)</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> </span>{</span><br><span class="line">  <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">char</span> ch=gc();</span><br><span class="line">  <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch)) ch=gc();</span><br><span class="line">  <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) ans=((ans&lt;&lt;<span class="number">2</span>)+ans&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=gc();</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">namespace</span> modular {</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">998244353</span>;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> a+b&lt;mod?a+b:a+b-mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> a&lt;b?a-b+mod:a-b; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>{ <span class="keyword">return</span> (ll)a*b%mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=a+b&lt;mod?a+b:a+b-mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Dec</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=a&lt;b?a-b+mod:a-b; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span>&amp;a,<span class="keyword">int</span> b)</span> </span>{ a=(ll)a*b%mod; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span> </span>{ <span class="keyword">int</span> ret=<span class="number">1</span>;<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,Mul(a,a)) (p&amp;<span class="number">1</span>)&amp;&amp;(Mul(ret,a),<span class="number">1</span>);<span class="keyword">return</span> ret; }</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> a)</span> </span>{ <span class="keyword">return</span> ksm(a,mod<span class="number">-2</span>); }</span><br><span class="line">}</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> modular;</span><br><span class="line"><span class="keyword">int</span> inv[<span class="number">1</span>&lt;&lt;<span class="number">20</span>],lim,tim,invv[<span class="number">21</span>];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;w[<span class="number">21</span>],rev[<span class="number">21</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init_ntt</span><span class="params">()</span> </span>{</span><br><span class="line">  w[<span class="number">20</span>].resize(<span class="number">1</span>&lt;&lt;<span class="number">20</span>),w[<span class="number">20</span>][<span class="number">0</span>]=<span class="number">1</span>,w[<span class="number">20</span>][<span class="number">1</span>]=ksm(<span class="number">3</span>,(mod<span class="number">-1</span>)&gt;&gt;<span class="number">21</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">2</span>,up=<span class="number">1</span>&lt;&lt;<span class="number">20</span>;i&lt;up;++i) w[<span class="number">20</span>][i]=mul(w[<span class="number">20</span>][i<span class="number">-1</span>],w[<span class="number">20</span>][<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">19</span>;~i;--i) {</span><br><span class="line">    w[i].resize(<span class="number">1</span>&lt;&lt;i);</span><br><span class="line">    <span class="keyword">for</span>(ri j=<span class="number">0</span>,up=<span class="number">1</span>&lt;&lt;i;j&lt;up;++j) w[i][j]=w[i+<span class="number">1</span>][j&lt;&lt;<span class="number">1</span>];</span><br><span class="line">  }</span><br><span class="line">  invv[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>,iv=mod+<span class="number">1</span>&gt;&gt;<span class="number">1</span>;i&lt;<span class="number">21</span>;++i) invv[i]=mul(invv[i<span class="number">-1</span>],iv);</span><br><span class="line">  inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">2</span>,up=<span class="number">1</span>&lt;&lt;<span class="number">20</span>;i&lt;up;++i) inv[i]=mul(inv[mod-mod/i*i],mod-mod/i);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> up)</span> </span>{</span><br><span class="line">  lim=<span class="number">1</span>,tim=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(lim&lt;up)  lim&lt;&lt;=<span class="number">1</span>,++tim;</span><br><span class="line">  <span class="keyword">if</span>(rev[tim].size()) <span class="keyword">return</span>;</span><br><span class="line">  rev[tim].resize(lim);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;lim;++i) rev[tim][i]=(rev[tim][i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(tim<span class="number">-1</span>));</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ntt</span><span class="params">(poly&amp;a,<span class="keyword">int</span> typ)</span> </span>{</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;lim;++i) <span class="keyword">if</span>(i&lt;rev[tim][i]) swap(a[i],a[rev[tim][i]]);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>,t=<span class="number">0</span>,a0,a1;i&lt;lim;i&lt;&lt;=<span class="number">1</span>,++t) <span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;lim;j+=i&lt;&lt;<span class="number">1</span>) {</span><br><span class="line">    <span class="keyword">for</span>(ri k=<span class="number">0</span>;k&lt;i;++k) {</span><br><span class="line">      a0=a[j+k],a1=mul(a[j+k+i],w[t][k]);</span><br><span class="line">      a[j+k]=add(a0,a1),a[j+k+i]=dec(a0,a1);</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span>(~typ) <span class="keyword">return</span>;</span><br><span class="line">  reverse(++a.begin(),a.end());</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;lim;++i) Mul(a[i],invv[tim]);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span>*(poly a,poly b) {</span><br><span class="line">  <span class="keyword">int</span> n=(<span class="keyword">int</span>)a.size(),m=(<span class="keyword">int</span>)b.size(),t=n+m<span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">if</span>(t&lt;=<span class="number">128</span>) {</span><br><span class="line">    <span class="function">poly <span class="title">c</span><span class="params">(t)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;n;++i) <span class="keyword">if</span>(a[i]) <span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;m;++j) Add(c[i+j],mul(a[i],b[j]));</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">  }</span><br><span class="line">  init(t);</span><br><span class="line">  a.resize(lim),ntt(a,<span class="number">1</span>);</span><br><span class="line">  b.resize(lim),ntt(b,<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;lim;++i) Mul(a[i],b[i]);</span><br><span class="line">  <span class="keyword">return</span> ntt(a,<span class="number">-1</span>),a.resize(t),a;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span>-(poly a,poly b) {</span><br><span class="line">  <span class="keyword">int</span> n=(<span class="keyword">int</span>)b.size();</span><br><span class="line">  <span class="keyword">if</span>((<span class="keyword">int</span>)a.size()&lt;n) a.resize(n);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;n;++i) Dec(a[i],b[i]);</span><br><span class="line">  <span class="keyword">return</span> a;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_inv</span><span class="params">(poly a,<span class="keyword">int</span> K)</span> </span>{</span><br><span class="line">  poly b(1,Inv(a[0])),c;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;K;i&lt;&lt;=<span class="number">1</span>) {</span><br><span class="line">    init(i*<span class="number">3</span>);</span><br><span class="line">    b.resize(lim),ntt(b,<span class="number">1</span>);</span><br><span class="line">    c=a,c.resize(i&lt;&lt;<span class="number">1</span>),c.resize(lim),ntt(c,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(ri j=<span class="number">0</span>;j&lt;lim;++j) Mul(b[j],dec(<span class="number">2</span>,mul(b[j],c[j])));</span><br><span class="line">    ntt(b,<span class="number">-1</span>),b.resize(i&lt;&lt;<span class="number">1</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> b.resize(K),b;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_deriv</span><span class="params">(poly a)</span> </span>{</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>,up=(<span class="keyword">int</span>)a.size();i&lt;up;++i) a[i<span class="number">-1</span>]=mul(a[i],i);</span><br><span class="line">  <span class="keyword">return</span> a.pop_back(),a;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_integ</span><span class="params">(poly a)</span> </span>{</span><br><span class="line">  a.pb(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=(<span class="keyword">int</span>)a.size()<span class="number">-1</span>;i;--i) a[i]=mul(inv[i],a[i<span class="number">-1</span>]);</span><br><span class="line">  <span class="keyword">return</span> a[<span class="number">0</span>]=<span class="number">0</span>,a;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_ln</span><span class="params">(poly a,<span class="keyword">int</span> K)</span> </span>{ <span class="keyword">return</span> a=poly_inv(a,K)*poly_deriv(a),a.resize(K<span class="number">-1</span>),poly_integ(a); }</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">poly_exp</span><span class="params">(poly a,<span class="keyword">int</span> K)</span> </span>{</span><br><span class="line">  poly b(1,1),c;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;K;i&lt;&lt;=<span class="number">1</span>) {</span><br><span class="line">    c=a,c.resize(i&lt;&lt;<span class="number">1</span>),Add(c[<span class="number">0</span>],<span class="number">1</span>);</span><br><span class="line">    b=b*(c-poly_ln(b,i&lt;&lt;<span class="number">1</span>)),b.resize(i&lt;&lt;<span class="number">1</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> b.resize(K),b;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> fac[N],ifac[N],f[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span> </span>{ <span class="keyword">return</span> n&lt;m||m&lt;<span class="number">0</span>?<span class="number">0</span>:mul(fac[n],mul(ifac[m],ifac[n-m])); }</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</span><br><span class="line">  fac[<span class="number">0</span>]=fac[<span class="number">1</span>]=ifac[<span class="number">0</span>]=ifac[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">2</span>;i&lt;=<span class="number">100000</span>;++i) {</span><br><span class="line">    fac[i]=mul(fac[i<span class="number">-1</span>],i);</span><br><span class="line">    ifac[i]=mul(ifac[i<span class="number">-1</span>],inv[i]);</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">poly F;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init_F</span><span class="params">()</span> </span>{</span><br><span class="line">  F.resize(<span class="number">100001</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">1</span>;i&lt;=<span class="number">100000</span>;++i) F[i]=ifac[i];</span><br><span class="line">  F=poly_exp(F,<span class="number">100001</span>);</span><br><span class="line">  <span class="keyword">for</span>(ri i=<span class="number">0</span>;i&lt;=<span class="number">100000</span>;++i) Mul(F[i],fac[i]);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">  <span class="meta">#<span class="meta-keyword">ifdef</span> ldxcaicai</span></span><br><span class="line">  freopen(<span class="string">&quot;lx.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">  init_ntt();</span><br><span class="line">  init();</span><br><span class="line">  init_F();</span><br><span class="line">  <span class="keyword">for</span>(ri tt=read();tt;--tt) <span class="built_in">cout</span>&lt;&lt;F[read()]&lt;&lt;<span class="string">&apos;\n&apos;</span>;  </span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>
</details>
<hr>
<h2 id="wd&#x4E0E;&#x79EF;&#x6728;"><a class="markdownIt-Anchor" href="#wd&#x4E0E;&#x79EF;&#x6728;"></a> <a href="https://www.luogu.com.cn/problem/P5162" target="_blank" rel="noopener">WD&#x4E0E;&#x79EF;&#x6728;</a></h2>
<details><summary>&#x89E3;&#x9898;&#x601D;&#x8DEF;&#xFF1A;</summary>
<p>&#x8003;&#x8651;&#x975E;&#x7A7A;&#x96C6;&#x5408;&#x751F;&#x6210;&#x51FD;&#x6570;&#x4E3A; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>&#x2212;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">e^x-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.747722em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> &#xFF0C;&#x8BBE; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span> &#x4E3A;&#x5206;&#x6BCD;&#x751F;&#x6210;&#x51FD;&#x6570;&#xFF0C; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span></span></span></span> &#x4E3A;&#x5206;&#x5B50;&#x751F;&#x6210;&#x51FD;&#x6570;</p>
<p>&#x90A3;&#x4E48;&#x663E;&#x7136;&#x6709; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo>=</mo><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mo>+</mo><mi mathvariant="normal">&#x221E;</mi></mrow></msubsup><mfrac><mrow><mo stretchy="false">(</mo><msup><mi>e</mi><mi>x</mi></msup><mo>&#x2212;</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>i</mi></msup></mrow><mrow><mi>i</mi><mo stretchy="false">!</mo></mrow></mfrac><mi>i</mi><mo stretchy="false">!</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>&#x2212;</mo><mo stretchy="false">(</mo><msup><mi>e</mi><mi>x</mi></msup><mo>&#x2212;</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mo>&#x2212;</mo><msup><mi>e</mi><mi>x</mi></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">F=\sum\limits_{i=0}^{+\infty}\frac{(e^x-1)^i}{i!}i!=\frac{1}{1-(e^x-1)}=\frac1{2-e^x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.436005em;vertical-align:-0.9776689999999999em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4583360000000003em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">&#x2211;</span></span></span><span style="top:-3.950005em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span><span class="mord mtight">&#x221E;</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.11646em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mclose mtight">!</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7385428571428572em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9020857142857143em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">i</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.365108em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">&#x2212;</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5935428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2484389999999999em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5935428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<p>&#x540C;&#x7406;&#x80FD;&#x63A8;&#x51FA; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>&#x2212;</mo><mn>1</mn></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mo>&#x2212;</mo><msup><mi>e</mi><mi>x</mi></msup><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">G=\frac{e^x-1}{(2-e^x)^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.43098em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.91098em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5935428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7385428571428572em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<p>&#x7136;&#x540E;&#x505A;&#x5B8C;&#x4E86;</p>
</details>
<details><summary>CODE</summary>
</details></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">ldxcaicai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://xdl030112.github.io/sol13/">http://xdl030112.github.io/sol13/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%A2%98%E8%A7%A3/">题解    </a></div><div class="post_share"></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/CF1270/"><img class="prev_cover lazyload" data-src="/img/cover.png" onerror="onerror=null;src='/img/cover.png'"><div class="label">Previous Post</div><div class="prev_info"><span>CodeForces 1270 简要题解</span></div></a></div><div class="next-post pull_right"><a href="/sol12/"><img class="next_cover lazyload" data-src="/img/cover.png" onerror="onerror=null;src='/img/cover.png'"><div class="label">Next Post</div><div class="next_info"><span>杂题乱做 Round12</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> Recommend</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/sol9/" title="杂题乱做 Round9"><img class="relatedPosts_cover lazyload"data-src="/img/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-11-27</div><div class="relatedPosts_title">杂题乱做 Round9</div></div></a></div><div class="relatedPosts_item"><a href="/sol15/" title="杂题乱做 Round15"><img class="relatedPosts_cover lazyload"data-src="/img/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-14</div><div class="relatedPosts_title">杂题乱做 Round15</div></div></a></div><div class="relatedPosts_item"><a href="/sol14/" title="杂题乱做 Round14"><img class="relatedPosts_cover lazyload"data-src="/img/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-03</div><div class="relatedPosts_title">杂题乱做 Round14</div></div></a></div><div class="relatedPosts_item"><a href="/sol16/" title="杂题乱做 Round16"><img class="relatedPosts_cover lazyload"data-src="/img/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-17</div><div class="relatedPosts_title">杂题乱做 Round16</div></div></a></div><div class="relatedPosts_item"><a href="/sol2/" title="杂题乱做 Round2"><img class="relatedPosts_cover lazyload"data-src="/img/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-10-28</div><div class="relatedPosts_title">杂题乱做 Round2</div></div></a></div><div class="relatedPosts_item"><a href="/sol4/" title="杂题乱做 Round4"><img class="relatedPosts_cover lazyload"data-src="/img/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-11-03</div><div class="relatedPosts_title">杂题乱做 Round4</div></div></a></div></div><div class="clear_both"></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By ldxcaicai</div><div class="framework-info"><span>Driven </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="Read Mode"></i><i class="fa fa-plus" id="font_plus" title="Increase font size"></i><i class="fa fa-minus" id="font_minus" title="Decrease font size"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="Traditional Chinese and Simplified Chinese Conversion" target="_self">简</a><i class="darkmode fa fa-moon-o" id="darkmode" title="Dark Mode"></i></div><div id="rightside-config-show"><div id="rightside_config" title="Setting"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="Table of Contents" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="Back to top" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>$(function () {
  $('span.katex-display').wrap('<div class="katex-wrap"></div>')
})</script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/ClickShowText.js"></script></body></html>